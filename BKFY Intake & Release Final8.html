<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> Intake & Release</title>
  <style>
    body {  
      font-family: Arial, sans-serif;  
      margin: 0;  
      line-height: 1.6;  
      background: #f4f8fb;  
      padding-bottom: 70px;  
    }
    .question-header { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
    .question-text { font-size: 16px; margin-bottom: 10px; }
    
    /* New structure for choice rendering */
    .choice-wrapper {
      display: flex;
      align-items: center;
      border: 1px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      margin: 10px 0;
      background: #ffffff;
      transition: background-color 0.3s ease, border-color 0.3s ease;
    }
    .choice-wrapper:hover {
      background: #e6f0ff;
    }
    .choice-wrapper.selected-wrapper { /* Applied to the wrapper when selected */
      background: #d0ebff;
      border-color: #3b82f6;
    }
    /* Styles for study mode feedback */
    .choice-wrapper.study-correct {
        background-color: #dcfce7;
        border-color: #22c55e;
    }
    .choice-wrapper.study-incorrect {
        background-color: #fee2e2;
        border-color: #ef4444;
    }


    .choice-button-main-area { /* This is the label now */
      flex-grow: 1;
      display: flex;
      align-items: center;
      cursor: pointer;
      padding-right: 10px; /* Space before the eye icon button */
    }
    .choice-button-main-area input[type="radio"] {
      margin-right: 10px;  
      -webkit-appearance: radio;  
      -moz-appearance: radio;
      appearance: radio;
    }
    .choice-text-container {
        /* flex-grow: 1; */ /* No longer needed here, label is flex-grow */
    }
    .actual-choice-text-visually-obscured {  
        opacity: 0.3;
        text-decoration: line-through;
    }
    .toggle-visibility-btn {
        background: none;
        border: none;
        font-size: 1em;  
        cursor: pointer;
        padding: 0 5px;
        /* margin-left: auto; /* No longer needed due to flex on wrapper */
        color: #555;
        display: flex;  
        align-items: center;
        justify-content: center;
        flex-shrink: 0; /* Prevent button from shrinking */
    }
    .toggle-visibility-btn svg {  
        width: 20px;
        height: 20px;
    }
    .toggle-visibility-btn:hover {
        color: #000;
    }

    .correct { border: 2px solid green; background: #e0ffe0; padding: 10px; margin-bottom:10px; border-radius: 5px; }
    .incorrect { border: 2px solid red; background: #ffe0e0; padding: 10px; margin-bottom:10px; border-radius: 5px; }
    .explanation { font-style: italic; color: #555; margin-top: 10px; display: none;} /* Hidden by default */

    .question-actions-bar {
      display: flex;
      justify-content: center;  
      align-items: center;
      flex-wrap: wrap;  
      gap: 10px;  
      padding: 15px 10px;  
      margin-top: 20px;  
      margin-bottom: 10px;  
    }
    .question-actions-bar button {
      padding: 10px 15px;  
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
      border: 1px solid #ccc;
      background-color: #fff;  
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      transition: background-color 0.2s ease, border-color 0.2s ease;
    }
    .question-actions-bar button:hover {
      background-color: #f8f9fa;
      border-color: #bbb;
    }
    .question-actions-bar button#submitBtn {
        background-color: #22c55e;  
        color: white;
        border-color: #22c55e;
    }
    .question-actions-bar button#submitBtn:hover {
        background-color: #16a34a;
    }
    .review-actions-bar {  
        text-align: center;
        padding: 10px 0 20px 0;  
    }
    .review-actions-bar button {
        padding: 10px 20px;  
        font-size: 1rem;
        cursor: pointer;
        border-radius: 5px;
        background-color: #007bff;
        color: white;
        border: none;
        margin: 5px;  
    }
    .review-actions-bar button:hover {
        background-color: #0056b3;
    }


    .quiz-controls { /* Footer */
      justify-content: center;  
      align-items: center;
      padding: 10px 20px;  
      background: #dbeafe;
      position: fixed;
      bottom: 0;
      left: 0;  
      right: 0;  
      display: flex;
      z-index: 100;  
      box-sizing: border-box;  
    }
    .quiz-controls .progress-info {  
        display: flex;
        align-items: center;
        justify-content: space-between;  
        width: 100%;
    }
    
    #progressText { font-size: 16px; margin: 0 10px 0 0; }
    /* .choice-button.selected is replaced by .choice-wrapper.selected-wrapper */
    

    #resultsScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #4a90e2;  
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;  
      padding: 10px;
      box-sizing: border-box;
    }

    .results-card {
      display: flex;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.3);
      overflow: auto;  
      width: 95%;  
      max-width: 900px;  
      max-height: 90vh;  
      flex-direction: column;  
    }

    .results-left-panel {
      flex-shrink: 0;  
      background: #37474f;  
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      padding: 20px;
      text-align: center;
      border-top-left-radius: 10px;  
      border-top-right-radius: 10px;
      border-bottom-left-radius: 0;
    }

    .results-right-panel {
      flex-grow: 1;  
      background: #ffffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      text-align: center;
      border-bottom-left-radius: 10px;  
      border-bottom-right-radius: 10px;
      border-top-right-radius: 0;
    }
     @media (min-width: 768px) {  
      .results-card {
        flex-direction: row;  
        min-height: 400px;  
        overflow: hidden;  
      }
      .results-left-panel {
        border-top-right-radius: 0;
        border-bottom-left-radius: 10px;
        flex-basis: 300px;  
      }
      .results-right-panel {
        border-top-right-radius: 10px;
        border-bottom-left-radius: 0;
      }
    }


    .score-circle {
      width: 100px;  
      height: 100px;
      border-radius: 50%;
      border: 6px solid #e0e0e0;  
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;  
      font-weight: bold;
      color: #4CAF50;  
      margin-bottom: 15px;  
      position: relative;
    }

    .score-circle::before {
      content: '';
      position: absolute;
      top: -6px;  
      left: -6px;
      width: calc(100% + 12px);  
      height: calc(100% + 12px);
      border-radius: 50%;
      border: 6px solid transparent;  
      border-top-color: #4CAF50;  
      border-right-color: #4CAF50;
      transform: rotate(-45deg);  
      box-sizing: border-box;
    }

    .upload-button {  
      padding: 12px 25px;  
      font-size: 16px;  
      background-color: #4CAF50;  
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 20px;  
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: background-color 0.3s ease;
    }

    .upload-button:hover {
      background-color: #45a049;
    }

    .attention-message {
      background: white;
      padding: 15px;  
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-top: 15px;  
      width: 90%;
      max-width: 800px;
      text-align: center;
      font-size: 14px;  
      color: #333;
    }

    #quizContentScrollable {
      max-height: calc(100vh - 100px);  
      overflow-y: auto;
      padding: 10px 15px 0 0;  
    }
    
    #mainQuizLayout {  
        display: flex;
        padding-top: 40px;  
    }

    #sidebar {
      width: 60px;
      background: #e3edf8;
      position: fixed;
      top: 40px;  
      bottom: 50px;  
      overflow-y: auto;  
      z-index: 50;  
      padding-top: 10px;  
      padding-bottom: 10px;
      transition: width 0.3s ease, opacity 0.3s ease, bottom 0.3s ease;
    }

    #sidebar::-webkit-scrollbar {
      width: 0px;  
      background: transparent;  
    }
    #sidebar::-webkit-scrollbar-thumb {
      background: transparent;  
    }

    #questionNav {
      list-style: none;
      padding: 0;  
      margin: 0;  
      text-align: center;
    }
    
    #quizFormContainer {  
        margin-left: 75px;  
        flex-grow: 1;
        padding-right: 15px;  
        transition: margin-left 0.3s ease;
    }


    .header-bar {  
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #1f2937;
      color: white;
      padding: 10px 20px;
      font-size: 14px;
      position: fixed;  
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;  
      box-sizing: border-box;
    }

    .intro-screen-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #fbbf24;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      flex-direction: column;
      padding: 15px;  
      box-sizing: border-box;
    }

    .intro-card-container {
      background: white;
      padding: 20px;  
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      width: 90%;
      max-width: 450px;  
    }
    .intro-card-container h2 {
        font-size: 1.4rem;  
        margin-bottom: 0.5em;
    }
    .intro-card-container p {
        font-size: 0.85rem;  
        margin-bottom: 1em;
    }
    .intro-buttons-container {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 15px;
    }


    .intro-start-button {
      /* margin-top: 15px;   */
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #10b981;
      color: white;
      border: none;
      border-radius: 5px;
    }

    .question-count-select-container {
      margin-top: 15px;  
      margin-bottom: 15px; /* Added margin for spacing */
    }

    .question-count-label {
      font-size: 1rem;  
      margin-right: 8px;
    }

    .question-count-select {
      padding: 8px 10px;  
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 1rem;  
    }
    
    #homeBtn {
      position: fixed;
      bottom: 80px; 
      right: 20px;
      width: 50px;
      height: 50px;
      background-color: #0d6efd;
      color: white;
      border: none;
      border-radius: 50%;
      display: none; /* Hidden by default */
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
      z-index: 1001;
      transition: background-color 0.3s ease;
    }
    #homeBtn:hover {
      background-color: #0b5ed7;
    }

    #submitScreen {
      display: none;  
      position: fixed;  
      top: 0;  
      left: 0;  
      width: 100%;  
      height: 100%;  
      background: rgba(0,0,0,0.6);  
      z-index: 9998;  
      align-items: center;
      justify-content: center;
      padding: 15px;
      box-sizing: border-box;
    }
    .submit-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.25);  
      width: 100%;
      max-width: 550px;  
      display: flex;
      flex-direction: column;  
    }
    .submit-panel {
      padding: 20px;
      text-align: center;
      flex: 1;
    }
    .submit-panel-left {
      background: #f0f4f8;  
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;  
    }
    .submit-panel-right {
      background: #ffffff;
      border-bottom-left-radius: 10px;
      border-bottom-right-radius: 10px;
    }
     .submit-panel button {
        padding: 12px 22px;  
        font-size: 1rem;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 15px;
        transition: background-color 0.2s ease;
    }
    .submit-go-back-btn { background: #4b5563; color: white; }  
    .submit-go-back-btn:hover { background: #374151; }
    .submit-confirm-btn { background: #22c55e; color: white; }  
    .submit-confirm-btn:hover { background: #16a34a; }


    @media (min-width: 640px) {  
        .submit-card {
            flex-direction: row;  
        }
        .submit-panel-left {
            border-top-right-radius: 0;
            border-bottom-left-radius: 10px;
        }
        .submit-panel-right {
            border-top-right-radius: 10px;  
            border-bottom-left-radius: 0;  
            border-bottom-right-radius: 10px;  
        }
    }
    #confirmSubmitMessage {
        color: red;
        font-size: 0.9em;
        margin-top: 10px;
        min-height: 1.2em;  
    }

    @media (max-width: 767px) {
        body {
            padding-bottom: 60px;  
        }
        #sidebar {
            display: none;  
        }
        #quizFormContainer {
            margin-left: 15px;  
            padding-right: 15px;
        }
        .choice-wrapper {  
            padding: 10px;
        }
        .choice-button-main-area {  
            font-size: 1rem;
        }
         .choice-button-main-area input[type="radio"] {
            margin-right: 8px;
        }
        .toggle-visibility-btn {
            padding: 0 2px;  
        }
        .quiz-controls {  
            padding: 8px 10px;  
        }
        .quiz-controls .progress-info span {
             font-size: 0.85rem;
        }
        
         .header-bar {
            padding: 10px 15px;
        }
        .header-bar div {
            font-size: 0.85rem;  
        }
        #progressText {
            font-size: 0.9rem;
        }
        .question-header { font-size: 1.1rem; }
        .question-text { font-size: 0.95rem; }

        #homeBtn {
            bottom: 70px;
            right: 15px;
            width: 45px;
            height: 45px;
        }

        .results-card { max-height: 85vh; }  
        .score-circle { width: 90px; height: 90px; font-size: 28px; border-width: 5px; }
        .score-circle::before { top: -5px; left: -5px; width: calc(100% + 10px); height: calc(100% + 10px); border-width: 5px;}
        .upload-button { padding: 10px 20px; font-size: 1rem; }
        .attention-message { font-size: 0.85rem; padding: 10px; }

        .question-actions-bar button {
            padding: 8px 12px;
            font-size: 0.9rem;
            flex-grow: 1;  
            min-width: 80px;  
        }
         .question-actions-bar {
            gap: 5px;  
         }
    }

    @media (max-width: 480px) {  
        .question-actions-bar button {
            font-size: 0.85rem;
        }
        .intro-card-container h2 { font-size: 1.2rem; }
        .intro-card-container p { font-size: 0.8rem; }
        .question-count-label, .question-count-select { font-size: 0.9rem; }
    }

  </style>
</head>
<body>
  <div id="introScreen" class="intro-screen-container">
    <div class="intro-card-container">
      <svg width="120" height="120" viewBox="0 0 200 200" style="margin-bottom: 15px; margin-left: auto; margin-right: auto;">
        <defs>
          <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#0284c7;stop-opacity:1" />
            <stop offset="100%" style="stop-color:#38bdf8;stop-opacity:1" />
          </linearGradient>
        </defs>
        <path d="M 20 150 L 50 20 L 90 20 L 90 120 L 110 120 L 110 20 L 150 20 L 180 150 L 150 150 L 130 90 L 70 90 L 50 150 Z" fill="url(#grad1)"></path>
        <rect x="55" y="25" width="30" height="90" fill="#1e293b" transform="skewX(-10)"></rect>
        <rect x="115" y="25" width="30" height="90" fill="#0ea5e9" transform="skewX(-10)"></rect>
        <text x="100" y="180" font-family="Arial, sans-serif" font-size="28" fill="#37474f" text-anchor="middle" font-weight="bold">BKRDI-FY</text>
        <text x="100" y="200" font-family="Arial, sans-serif" font-size="14" fill="#6b7280" text-anchor="middle" font-weight="bold">TEST & STUDY</text>
      </svg>
      <h2>Do Not Start Until Instructed</h2>
      <p>Activity conducted during this exam might actually matter.</p>
      
      <div class="question-count-select-container">
        <label for="questionCount" class="question-count-label">Number of Questions:</label>
        <select id="questionCount" class="question-count-select">
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <!-- "All Questions" option will be added here by JavaScript -->
        </select>
      </div>

      <div class="intro-buttons-container">
        <button onclick="startExam()" class="intro-start-button">Start Exam</button>
        <button onclick="startStudy()" class="intro-start-button" style="background-color: #f59e0b;">Answer & Study</button>
      </div>
    </div>
  </div>

  <div id="mainQuizContainer" style="display:none;">  
    <div class="header-bar">  
      <div><strong>Class 45</strong></div>
      <div id="mainHeaderTitle">CJF</div> 
      <div><strong id="timer">30:00</strong></div>
    </div>

    <div id="mainQuizLayout">
      <nav id="sidebar">
        <ul id="questionNav"></ul>
      </nav>
      <div id="quizFormContainer">
        <div id="quizContentScrollable">
          <div id="progress" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding-top:10px;">
            <button type="button" onclick="flagQuestion()" id="flagButton" style="font-size: 14px; padding: 5px 10px;">🚩 Flag</button>
            <span id="progressText"></span>
          </div>
          <div class="review-actions-bar" id="reviewActionsTop" style="display:none;"> <button onclick="returnToHome()">Retake Test</button>
          </div>
          <form id="quizForm"></form>
          <div class="question-actions-bar">
            <button id="prevBtn" type="button" onclick="prevQuestion()">⟵ Previous</button>
            <button id="skipBtn" type="button" onclick="skipQuestion()">⏭ Skip</button>
            <button id="submitBtn" type="button" onclick="showSubmitScreen()" style="display: none;">✅ Submit</button>
            <button id="nextBtn" type="button" onclick="nextQuestion()">Next ⟶</button>
          </div>
          <div id="studyEndActions" class="review-actions-bar" style="display:none;">
            <button id="nextSetBtn" onclick="startNextStudySet()">Next Set of Questions</button>
            <button id="retryIncorrectBtn" onclick="retryIncorrectQuestions()">Retry Incorrect Questions</button>
            <button onclick="returnToHome()">Return to Home</button>
          </div>
          <div class="review-actions-bar" id="reviewActionsBottom" style="display:none;"> <button onclick="returnToHome()">Retake Test</button>
          </div>
        </div>
      </div>
    </div>
    <div class="quiz-controls">  
      <div class="progress-info">
        <span id="progressTextBottom">Question 1 of 60</span>
        <span style='font-size: 0.8em;'>BKRDIFY Version 2.1.87</span>
      </div>
    </div>
  </div>

  <div id="submitScreen">  
    <div class="submit-card">
      <div class="submit-panel submit-panel-left">
        <h2>Return to Exam</h2>
        <p>By clicking this button, you will be directed back to the exam.</p>
        <button onclick="hideSubmitScreen()" class="submit-go-back-btn">Go Back</button>
      </div>
      <div class="submit-panel submit-panel-right">
        <h2>Exit Exam</h2>
        <p>Click 'Submit Exam' to upload and close this exam file.</p>
        <label style="margin: 20px 0; display: flex; align-items: center; justify-content: center; font-size: 14px;">
          <input type="checkbox" id="confirmSubmit" style="margin-right: 10px; transform: scale(1.5);">
          I confirm that I have completed my exam.
        </label>
        <button onclick="confirmAndSubmit()" class="submit-confirm-btn">Submit Exam</button>
        <div id="confirmSubmitMessage"></div>
      </div>
    </div>
  </div>

  <div id="resultsScreen" style="display: none;">
    <div class="results-card">
      <div class="results-left-panel">
        <svg width="100" height="100" viewBox="0 0 200 200">
            <path d="M 20 150 L 50 20 L 90 20 L 90 120 L 110 120 L 110 20 L 150 20 L 180 150 L 150 150 L 130 90 L 70 90 L 50 150 Z" fill="#0ea5e9"></path>
            <rect x="55" y="25" width="30" height="90" fill="#1e293b" transform="skewX(-10)"></rect>
            <rect x="115" y="25" width="30" height="90" fill="#38bdf8" transform="skewX(-10)"></rect>
            <text x="100" y="180" font-family="Arial, sans-serif" font-size="28" fill="#fff" text-anchor="middle" font-weight="bold">BKRDI-FY</text>
        </svg>
      </div>
      <div class="results-right-panel">
        <h3 style="font-size: 1.3rem; margin-bottom: 10px;">Preliminary Results</h3> <p style="font-size: 1rem; margin-bottom: 15px;">Objective Question Score *</p> <div class="score-circle">
          <span id="finalScore">75%</span>
        </div>
        <p style="font-size: 0.8rem; color: #555; margin-top: 10px;">This is the score for the objective questions only and I'm not sure what objective means</p> <p style="font-size: 0.8rem; color: #555; margin-top: 5px;">Test ID: <span id="testIdDisplay"></span></p> <button class="upload-button" onclick="showReviewPage()">Review</button>
      </div>
    </div>
    <div class="attention-message">
      <p><strong>ATTENTION:</strong></p>
      <p>You will be informed of your final score, which is this score, so yeah</p>
    </div>
  </div>

  <button id="homeBtn" onclick="returnToHome()" title="Return to Home Screen" style="display: none;">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
  </button>

  <script>
// Function to shuffle an array (Fisher-Yates algorithm)
function shuffleArray(array) {
  let newArray = [...array]; // Work on a copy
  for (let i = newArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
  }
  return newArray;
}

const newQuestionsFromUser = [ 
{"q":"What is the meaning of 'DOB' as it appears on an inmate's identification?","c":["Date of Birth","Date of Bond","Department of Bureaucracy","Document of Behavior"],"a":"0","e":"DOB-date of birth as it appears on the inmate's identification. Page: 139"},
{"q":"Beyond identifying information, what else do common features of arrest papers include regarding the charges?","c":["Only the number of charges.","The charges, including statute number(s) and number of charges.","Only the type of crime committed.","The court recommendations for sentencing."],"a":"1","e":"Common features of arrest papers include: charges, including the statute number(s) and the number of charges. Page: 138"},
{"q":"Which specific document is included in commitment papers that details the sentence an inmate has received?","c":["Writ of Sentence signed by a jury.","Court paperwork with sentencing information and any court recommendations.","Judges Final Verdict.","Probable cause affidavit."],"a":"1","e":"Common features of commitment papers include: court paperwork with sentencing information and any court recommendation. Page: 138"},
{"q":"What is the definition of 'Intake' in the context of correctional facilities?","c":["The transfer process between facilities.","The release process from a facility.","The admission process in a state correctional facility.","The admission process in a county detention facility."],"a":"3","e":"In county detention facilities, admission to a correctional facility is known as intake. Page: 137"},
{"q":"What does a 'Strip Search' in state facilities aim to discourage?","c":["PREA Violations.","The introduction and movement of contraband.","Disrespect to facility staff.","STG activities."],"a":"1","e":"In state facilities, strip searches may be conducted on inmates entering or exiting the facility and may be conducted at any time to discourage the introduction and movement of contraband. Page: 141"},
{"q":"What is the significance of 'Friction Ridge' in fingerprint identification?","c":["It is a raised portion of skin on fingers and palms.","Rapid-ID main use case.","It is a lowered portion of skin on fingers and palms","It is a type of skin disease."],"a":"0","e":"The friction ridge is a raised portion of skin on the fingers and palm of a hand that consists of connected ridge units. Page: 146"},
{"q":"What is the primary function of the 'Biometric Identification Solution (BIS)' system?","c":["To manage inmate visitation schedules.","To search fingerprint databases with LiveScan machines.","To track inmate financial transactions.","To monitor inmate communications."],"a":"1","e":"Fingerprints and palm prints are submitted to FDLE electronically via a Biometric Identification Solutions (BIS) LiveScan machine where they are searched against state and national fingerprint databases to identify an individual. Page: 146"},
{"q":"Which state custody grade (Rule 33-601.210, F.A.C.) refers to inmates eligible for outside work assignments but not for placement in a community residential center?","c":["Community custody grade.","Medium custody grade.","Minimum custody grade.","Close custody grade."],"a":"2","e":"Minimum custody grade refers to inmates who are eligible for outside work assignments but not for placement in a community residential center. Page: 151"},
{"q":"What is the high-risk period for suicide for inmates during incarceration?","c":["After 30 days in custody.","Within the first 24 hours of incarceration.","During court appearances.","Upon release from the facility."],"a":"1","e":"Be aware that there is a high risk of suicide for inmates within the first 24 hours of incarceration. Page: 152"},
{"q":"What is the Florida Statute that defines DNA requirements for convicted or charged felons?","c":["Chapter 960, F.S.","s. 901.211, F.S.","s. 943.325, F.S.","Rule 33-601.502, F.A.C."],"a":"2","e":"Make sure you have obtained a DNA sample in accordance with the Florida Statutes (ss. 943.325 925.11), which require that DNA be collected from persons convicted of or arrested for felony or attempted offenses and convicted of certain misdemeanor offenses. Page: 154"},
{"q":"What is the purpose of 'victim contact notification' on arrest papers, if required by chapter 960, F.S.?","c":["To notify the victim of the arrest and allow them to request further information or services related to the case.","To inform the victim of the inmate's release date.","To obtain a statement from the victim for court.","To allow the victim to visit the inmate in custody."],"a":"0","e":"Common features of arrest papers include: victim contact notification, if required by chapter 960, F.S. Page: 138"},
{"q":"What is included in commitment papers that is signed by a judge?","c":["The inmate's personal statement.","Judgment and sentence pages.","Witness testimonies.","An inventory of the inmate's personal property."],"a":"1","e":"Common features of commitment papers include: judgment and sentence pages (signed by a judge). Page: 138"},
{"q":"What does a 'summary of inmate's behavior and adjustment from the sending agency' in commitment papers typically note?","c":["Their dietary preferences.","Their hobbies and interests.","Discipline, housing, and adjustment to a correctional setting.","Their educational background."],"a":"2","e":"Common features of commitment papers include: summary of inmate's behavior and adjustment to a correctional setting from the sending agency noting disciplinary issues and housing assignment while in jail. Page: 138"},
{"q":"What is verified regarding credit cards, bank cards, driver's licenses, and ID cards during an inmate property search?","c":["Their expiration date.","That they match the inmate's name.","Their monetary value.","Their country of origin."],"a":"1","e":"Also check that credit cards, bank cards, driver's license, and ID cards match the inmate's name. Page: 142"},
{"q":"What should be done with legal paperwork pertaining to an inmate's case that they are allowed to keep?","c":["It should be read thoroughly and systemically by the officer.","It should be brought to the property officer for storage.","It should be confiscated for official review.","Search but do not read; remove paper clips, staples, contraband before returning."],"a":"3","e":"Generally, facility policies and procedures permit inmates to keep: legal paperwork pertinent to the inmate's case (search but do not read; remove paper clips, staples, and any other contraband before returning the paperwork). Page: 142"},
{"q":"What is the purpose of the Offender Based Tracking System (OBTS) number in FCIC criminal histories?","c":["To track the inmate's medical appointments.","To track their arrest date, county, and arresting agency.","To manage their financial transactions.","To identify their family members."],"a":"1","e":"FCIC criminal histories contain...Florida arrest and registration history-Offender Based Tracking System (OBTS) number, date of arrest, county in which the arrest(s) occurred, arresting agency, and charge information. Page: 145"},
{"q":"What should be done with a 'too-dry hand' when attempting to obtain quality fingerprints?","c":["Wipe friction ridges with dry towel.","It should be moistened with lotion.","It can be moistened with water or by rubbing against an oily surface like the forehead.","It indicates a medical condition."],"a":"2","e":"Moisten a too-dry hand with water or rub against oily surfaces such as a forehead (never use lotion). Page: 147"},
{"q":"What is the consequence if the Biometric Identification Solution (BIS) database cannot read a fingerprint?","c":["It will automatically generate a new Rapid-ID.","It will not be able to make a positive identification.","It will forward the print to a ink pad review team.","It will temporarily store the print for later processing."],"a":"1","e":"If the BIS database cannot read the fingerprint, it will not be able to make a positive identification. Page: 148"},
{"q":"What is 'SID' as it relates to the Biometric Identification Solution (BIS)?","c":["State Identification Number.","State Identification Deposit","System Integration Data.","Secure Inmate Database."],"a":"0","e":"The electronic system will match prints to an existing state identification number, known as a SID. Page: 148"},
{"q":"What general housing assignment principle is applied to all admitted inmates?","c":["They are assigned to housing based on their last known address.","Housing assignments are based on an inmate's potential or basic risk and needs.","Inmates choose their housing unit upon arrival.","Housing is assigned randomly to prevent favoritism."],"a":"1","e":"Housing assignments are based on an inmate's potential or basic risk and needs. Page: 151"},
{"q":"What information is typically gathered during a health screening at a state facility's reception process?","c":["Immediate medical or psychological needs.","Details about the inmate's family medical history.","Long-term dietary preferences.","Past disciplinary actions."],"a":"0","e":"A health screening is done to establish immediate medical or psychological needs. Page: 140"},
{"q":"When is an inmate assigned a unique Department of Corrections number during the reception process?","c":["Upon release from the facility.","During the intake process.","During the reception process.","After their first court appearance."],"a":"2","e":"During reception, an inmate is assigned a unique Department of Corrections number. Page: 140"},
{"q":"What factors does the Department of Corrections reception process consider for inmate evaluation and facility assignment?","c":["Only the inmate's age and gender.","Offense nature/severity, sentence characteristics, mental/health status, age, and criminal history.","Their personal preferences for housing.","Their highest level of education and hobbies."],"a":"1","e":"The Department of Corrections reception process bases inmate evaluation and facility assignment on such factors as the nature and severity of the offense, characteristics of the sentence, and the inmate's mental and health status, age, and criminal history. Page: 140"},
{"q":"What is the consequence of introducing contraband into a facility, according to Florida Statutes?","c":["A verbal warning.","Loss of visitation privileges.","Additional criminal charges.","A minor fine."],"a":"2","e":"The Florida Statutes allow additional criminal charges to be made against an inmate who introduces contraband into the facility. Page: 142"},
{"q":"Which types of items are generally permitted for inmates to keep while in custody?","c":["Electronic devices and large sums of cash.","Personal hygiene items.","Limited personal clothing items.","Inmate Passes."],"a":"1","e":"Generally, facility policies and procedures permit inmates to keep: religious materials, legal paperwork pertinent to the inmate's case... medically necessary items as cleared by medical staff... photographs... personal hygiene items. Page: 142"},
{"q":"When inventorying clothing items for storage, how should they be described?","c":["As 'clothing' without specific details.","By type and color.","By brand name only.","By their estimated value."],"a":"1","e":"List all clothing by type and color. Page: 143"},
{"q":"What action should be taken with identification forms (photo ID, Social Security card) during inmate property inventory?","c":["Store them separately with verification.","Dispose of them if they appear altered or modified","Return them immediately to the inmate.","Ensure they are in the inmate's name.."],"a":"3","e":"Make sure that all forms of identification (for example, photo ID, Social Security card) are in the inmate's name. Page: 143"},
{"q":"What is the purpose of searching personal property, such as wallets, pocketbooks, and backpacks, during intake?","c":["To determine the inmate's financial status.","To confiscate all items from the inmate.","To remove and inspect all items for contraband.","To categorize items for donation."],"a":"2","e":"Remove and inspect all items from wallets, pocketbooks, backpacks, or any other articles associated with the inmate. Page: 141"},
{"q":"What is the role of the Florida Model Jail Standards regarding admissions into county detention facilities?","c":["They dictate the meal plans for inmates.","They prohibit admitting unconscious, seriously ill, or injured persons without medical clearance.","They establish guidelines for inmate visitation.","They determine staffing levels for the facility."],"a":"1","e":"Florida Model Jail Standards prohibit admitting unconscious, seriously ill, or injured persons into a county facility without medical clearance. Page: 139"},
{"q":"When is identity verification performed during an inmate's incarceration?","c":["When an inmate is moved to another area within the facility.","When a perimeter officer requests it","Only when the OIC Approves.","Never, after the initial intake process."],"a":"0","e":"Identity is also verified when an inmate is moved, such as between correctional facilities or to and from court, or when moved to another area within the facility. Page: 137"},
{"q":"What is the key characteristic of a 'Community custody grade' inmate in state correctional facilities?","c":["They are eligible for outside work assignments without supervision.","They are eligible for placement at a community residential facility.","They are required to be under direct, armed supervision.","They are sentenced to death."],"a":"1","e":"Community custody grade refers to inmates who are eligible for placement at a community residential facility. Page: 151"},
{"q":"If a juvenile detained in a county facility is awaiting court disposition, what criteria must have been met?","c":["They must have volunteered for detention.","Initial segregation","They must be accompanied by an medical professional.","They must have been direct filed, indicted, or waived."],"a":"3","e":"Juveniles detained in county facilities awaiting court disposition must have been direct filed, indicted, or waived. Page: 151"},
{"q":"What restrictions might apply to housing assignments for inmates?","c":["Only their educational background.","Security concerns, high-profile cases, or medical and psychological needs.","Their favorite sports team.","Their preferred color scheme for their cell."],"a":"1","e":"Restrictions may apply due to security concerns, high-profile cases, or medical and psychological needs, such as suicidal tendencies. Page: 152"},
{"q":"What is the court-determined date that marks the 'end (or expiration) of sentence' and can be reduced by gain time?","c":["NTA","ROR","EOS","DOB"],"a":"2","e":"EOS-end (or expiration) of sentence. This date is determined by the court at sentencing and can be reduced due to gain time. Page: 139"},
{"q":"What type of information is included in a criminal history printout from FCIC/NCIC, commonly found in commitment papers?","c":["Current criminal history printout from FCIC/NCIC.","Personal financial statements.","Driving record only.","Medical prescription history."],"a":"0","e":"Common features of commitment papers include: current criminal history printout from FCIC/NCIC (Florida Crime Information Center/ National Crime Information Center). Page: 138"},
{"q":"What are 'Arrest Papers'?","c":["Documents issued by the court after conviction.","Paperwork filed by the arresting officer that results in the person being arrested and taken to a detention facility for admission.","Internal memos between correctional officers.","Forms for requesting inmate transfers."],"a":"1","e":"Arrest papers are the paperwork filed by the arresting officer that results in the person being arrested and taken to a detention facility for admission. Page: 137"},
{"q":"What is the significance of the DC6-224 form?","c":["It is a medical consent form.","It is a visitor log.","It is the Property Receipt form.","It is a disciplinary report form."],"a":"2","e":"DC6-224 is property Reciept. Page: 143"},
{"q":"What is the primary responsibility of property officers in a correctional facility?","c":["Managing inmate disciplinary actions.","Storing all property, making sure that the property room is secured at all times, inventorying property, and documenting the delivery or release of all property.","Providing legal counsel to inmates.","Overseeing inmate visitation schedules."],"a":"1","e":"The property officer is accountable for storing all property, making sure that the property room is secured at all times, inventorying property, and documenting the delivery or release of all property. Page: 143"},
{"q":"What system does FDLE's identification unit use to receive electronically submitted fingerprints?","c":["LiveScan machines.","Rapid-ID","Traditional ink pads.","Portable handheld scanners only."],"a":"0","e":"FDLE's identification unit receives electronically submitted fingerprints through the LiveScan machine located at each criminal justice facility. Page: 148"},
{"q":"What information does an FBI number, when entered into the NCIC system, provide about a specific person?","c":["Only their Social Security Number.","PII","Their financial records and employment history.","Their Emergency Contacts"],"a":"1","e":"NCIC assigns the arrestee an FBI number which, when entered into the system, provides information on a specific person such as: PII, rest(s) for a person in the United States or its territories, location of arrest (county and state), arrecting agency, date of arrest, disposition of arrest. Page: 146"},
{"q":"What should be done with cell phones or other electronic devices found during an inmate's property inventory?","c":["Leave them turned on for verification.","List by brand and note condition, then turn off and remove the battery before storing.","Give them back to the inmate for safekeeping.","Connect them to the facility's Wi-Fi network."],"a":"1","e":"List cell phones or other electronic devices by brand and note the overall condition. Turn off devices and remove the battery before storing. Page: 143"},
{"q":"If an inmate refuses to sign the property inventory form, what is the correct procedure?","c":["Proceed with storage without a signature.","Notify Shift OIC, fill out 960 FS","Note the refusal, and a second officer must verify the inventory and sign.","Discard the inmate's property."],"a":"2","e":"If the inmate refuses to sign the property inventory form, note the refusal; a second officer will verify the inventory and sign the form. Page: 143"},
{"q":"Why is it important to check an inmate's identity when issuing hygiene items?","c":["To track their personal preferences.","To prevent inmates from using another's ID to get extra items.","To ensure they receive the most expensive items.","To confirm their release date."],"a":"1","e":"To prevent this, check the inmate's ID card, armband identification, or wristband identification to confirm that the photo matches the inmate being issued hygiene items. Page: 144"},
{"q":"What is 'PII' in the context of FCIC/NCIC information?","c":["Personal Inmate Identification","Preliminary Investigation Information","Personally Identifiable Information","Public Information Index"],"a":"2","e":"personally identifiable information (PII)-name, race, sex, date of birth, Social Security number, and aliases. Page: 145"},
{"q":"What is a 'Friction Ridge'?","c":["A type of security barrier in the facility.","A raised portion of skin on fingers and palms, unique to each individual.","A method of securing documents.","A common term for a fingerprint anomaly."],"a":"1","e":"The friction ridge is a raised portion of skin on the fingers and palm of a hand that consists of connected ridge units. Page: 146"},
{"q":"What is a 'Rapid ID Device' used for in criminal justice agencies?","c":["Scanning documents for storage.","A small, often portable fingerprint scanner using less than 10 prints, processing quickly for identification.","A tool for quickly accessing inmate financial records.","A device for remote surveillance of inmates."],"a":"1","e":"Many agencies in the state now confirm an inmate's identity with a Rapid ID device-a small, often portable fingerprint scanner using less than 10 prints. Page: 148"},
{"q":"Which organization compiles national standards and best practices for capturing and submitting facial images?","c":["The American Bar Association (ABA).","The Facial Identification Scientific Working Group (FISWG).","The National Association of Chiefs of Police (NACP).","The Department of Homeland Security (DHS)."],"a":"1","e":"When capturing, transmitting, and submitting facial images to FDLE, it is highly recommended that the national standards and best practice guidelines compiled by the Facial Identification Scientific Working Group (FISWG) be followed. Page: 148"},
{"q":"What information must be displayed at all times when an inmate is dressed?","c":["Their personal religious symbols.","Their inmate identification (wristband or ID card).","A copy of their charges.","Their family contact information."],"a":"1","e":"Inmate identification will be displayed at all times the inmate is dressed. Page: 149"},
{"q":"What is the security level for inmates in a county correctional facility who have serious and violent felony charges (past or pending) or who pose a threat to the safety of staff and facility security?","c":["Minimum security level.","Medium security level.","Maximum security level.","Community security level."],"a":"2","e":"Maximum security level is for inmates who are considered high risk. These inmates have serious and violent felony charges, either in the past or currently pending, or pose a threat to the safety of staff as well as the security of the facility. Page: 150"},
{"q":"According to Rule 33-601.210, F.A.C., which state custody grade refers to inmates who are sentenced to death?","c":["Community custody grade.","Minimum custody grade.","Close custody grade.","Maximum custody grade."],"a":"3","e":"Maximum custody grade refers to inmates who are sentenced to death. Page: 151"},
{"q":"When inventorying and documenting inmate property, it is important to:","c":["Inventory each item and note the exact number of every item.","Inventory the inmate's property in their presence whenever possible.","Ensure the property being inventoried belongs to the correct inmate when dealing with multiple inmates.","All answers Listed"],"a":"3","e":"During intake/reception, inventory each item and note the exact number of every item. Whenever possible, inventory the inmate's property in their presence. When dealing with multiple inmates, make sure that the property being inventoried belongs to the correct inmate. Page: 142"},
{"q":"Which of the following forms of identification are used to verify an inmate's identity during the intake/reception process?","c":["Driver's license","Sam's Club Card","Fingerprinting","Both 'Driver\\'s license' and 'Fingerprinting' are correct."],"a":"3","e":"During the intake/reception process, the inmate's identity is verified using various forms of identification, including...driver's license...or any other type of valid photo ID [and] fingerprinting. Page: 137"},
{"q":"When photographing an inmate at intake or reception, what are the requirements for capturing facial images?","c":["The inmate's eyes should be open, and their hair should not obstruct the full view of their face.","Side profile photograph and full frontal photograph","Only distinguishing scars or tattoos need to be photographed.","Photographs are not submitted to FDLE electronically."],"a":"0","e":"Basic good practices include making sure the inmate's eyes are open and that their hair is not obstructing the full view of their face. Page: 149"},
{"q":"Which of the following types of property are inmates generally allowed to keep while in custody, according to facility policies and procedures?","c":["Personal cell phones","Any property as described in CH33-601.520","All forms of jewelry","Legal paperwork pertinent to the inmate's case"],"a":"3","e":"Generally, facility policies and procedures permit inmates to keep... legal paperwork pertinent to the inmate's case. Page: 142"},
{"q":"What is a significant risk factor for inmates within the first 24 hours of incarceration?","c":["High risk of escape.","High risk of suicide.","High risk of property damage.","High risk of disciplinary issues."],"a":"1","e":"Be aware that there is a high risk of suicide for inmates within the first 24 hours of incarceration. Page: 152"},
{"q":"When are juveniles detained in county facilities awaiting court disposition required to have been \"direct filed\"?","c":["When they are charged as an adult and the case is transferred out of the Juvenile Division.","When they are awaiting transfer to a Juvenile State Facility.","When they are released on recognizance.","When they have a minimal criminal history."],"a":"0","e":"Juveniles detained in county facilities awaiting court disposition must have been direct filed, indicted, or waived. A juvenile is direct filed when they are charged as an adult and the case is transferred out of the Juvenile Division. Page: 151"},
{"q":"To prevent the introduction of contraband during a pat search, what should an officer do with outerwear like jackets or layered clothing?","c":["Leave it on the inmate during the entire search.","Search it while on the inmate, then remove and place it out of the inmate's reach before continuing.","Hand it back to the inmate immediately after searching.","Discard it if it appears suspicious."],"a":"1","e":"Wearing disposable gloves, search outerwear, such as jackets or layered clothing, then remove and place the piece(s) of clothing out of the inmate's reach before continuing the search. Page: 141"},
{"q":"The primary purpose for classification is to:","c":["Determine an inmate's work assignment only.","Place inmates in the type of housing that best meets their needs and to provide reasonable protection for all inmates.","Segregate all inmates immediately upon intake.","Reduce the overall inmate population."],"a":"1","e":"The primary purpose for classification is to place inmates in the type of housing that best meets their needs and to provide reasonable protection for all inmates. Page: 151"},
{"q":"What information is highly recommended to be followed when capturing, transmitting, and submitting facial images to FDLE?","c":["Florida Department of Law Enforcement (FDLE) internal guidelines only.","National standards and best practice guidelines compiled by the Facial Identification Scientific Working Group (FISWG).","Agency-specific guidelines only.","The inmate's preference for their photograph."],"a":"1","e":"When capturing, transmitting, and submitting facial images to FDLE, it is highly recommended that the national standards and best practice guidelines compiled by the Facial Identification Scientific Working Group (FISWG) be followed. Page: 148-149"},
{"q":"When an inmate returns to a county facility after being transported to a hospital emergency room due to injury or impairment, what must the officer provide?","c":["A verbal confirmation from the medical staff.","A signed waiver from medical staff","Written medical clearance from a physician.","A new set of arrest papers."],"a":"2","e":"When the inmate returns to the facility, the officer will provide written medical clearance from a physician. Page: 140"},
{"q":"Which of the following is a criterion used to establish an inmate's custody grade or security risk level?","c":["Current charges","Criminal history","Medical and psychological needs","All answers Listed"],"a":"3","e":"Some of the criteria that are used to establish an inmate's custody grade or security risk level include current charges, criminal history, age, sex, current and past behavior (discipline), medical and psychological needs, and degree of crime and length of sentence. Page: 150"},
{"q":"In county facilities, strip searches are to be conducted only in accordance with:","c":["Facility policy alone.","s. 901.211, F.S.","The discretion of the intake officer.","State facility guidelines."],"a":"1","e":"At county facilities, strip searches are to be conducted only in accordance with s. 901.211, F.S.. Page: 141"},
{"q":"After documenting an inmate's property, what is the next crucial step to ensure accuracy and accountability?","c":["Immediately deliver it to the property room.","Review the form with the inmate and obtain signatures.","Dispose of any questionable items.","Re-inventory the property with a supervisor."],"a":"1","e":"After you document the inmate's property, review the form with the inmate to make sure that all items are accounted for. The inmate and officer should sign and date the property inventory form. Page: 143"},
{"q":"In a state facility, the admission process, known as reception, involves several steps. Which of the following is a task completed during reception?","c":["Assigning a unique Department of Corrections number.","Conducting a health screening to establish immediate medical or psychological needs.","Notifying next of kin.","Both 'Assigning a unique Department of Corrections number.' and 'Conducting a health screening to establish immediate medical or psychological needs.' are correct."],"a":"3","e":"During reception, an inmate is assigned a unique Department of Corrections number. A health screening is done to establish immediate medical or psychological needs. Page: 140"},
{"q":"When restoring an inmate's stored property before release, what is the first step?","c":["Thoroughly search the property for contraband.","Verify the inmate's identity.","Have the inmate sign a receipt immediately.","Locate the inmate's stored property."],"a":"1","e":"Begin by verifying the inmate's identity. Using the inmate's ID, locate the inmate's stored property and thoroughly search it for contraband. Page: 154"},
{"q":"Which state custody grade refers to inmates who must be maintained within an armed perimeter or under direct, armed supervision when outside a secure perimeter?","c":["Minimum custody","Medium custody","Close custody","Maximum custody"],"a":"2","e":"Close custody grade refers to inmates who must be maintained within an armed perimeter or under direct, armed supervision when outside a secure perimeter. Page: 151"},
{"q":"The process by which inmates are discharged from a county detention facility or state correctional institution is known as:","c":["Intake","Reception","Release","Classification"],"a":"2","e":"Release is the process by which inmates are discharged from a county detention facility or state correctional institution. Page: 153"},
{"q":"When searching an inmate during intake/reception, which of the following is a critical procedure?","c":["Strip-Search as soon as they enter.","Conducting searches that are gender-specific unless emergency situations require otherwise.","Use of Body-Scanners for contraband detection.","Limiting body-cavity searches to only high-risk inmates to conserve resources."],"a":"1","e":"Searches of an inmate are gender specific (male officers search male inmates; female officers search female inmates) unless emergency situations require otherwise. Page: 141"},
{"q":"Money given to qualified inmates who are released from the custody of the Department of Corrections, in accordance with 33-601.502, F.A.C., is known as a:","c":["Discharge gratuity","Discharge Recognition","Stipend","Reintegration fund"],"a":"0","e":"A discharge gratuity is money given to qualified inmates who are released from the custody of the Department of Corrections in accordance with 33-601.502, F.A.C.. Page: 154"},
{"q":"In county correctional facilities, which of the following is considered a security level for inmates who are considered low risk, have adjusted well to incarceration, and have a minimal criminal history with no violent charges?","c":["Medium security level","Community security level","Minimum security level","Close security level"],"a":"2","e":"Minimum security level is for inmates who are considered low risk. These inmates have adjusted well to being incarcerated, have a minimal criminal history with no violent charges in their history, or are currently charged with a non-violent crime. Page: 150"},
{"q":"A summons or writ issued in place of a physical arrest, which requires a person to appear in court, is known by what abbreviation?","c":["ROR","Probable Cause Affidavit","NTA","Commitment Order"],"a":"2","e":"NTA-notice to appear. This is a summons or writ issued in place of a physical arrest and which requires a person to appear in court. Page: 138"},
{"q":"Pretrial release of an arrested person who promises in writing to appear for trial at a later date, with no monetary bond required, is referred to as:","c":["NTA","EOS","ROR","SB"],"a":"2","e":"ROR-release on recognizance, sometimes called a signature bond, is the pretrial release of an arrested person who promises in writing to appear for trial at a later date. No monetary bond is required before release. Page: 138"},
{"q":"The Florida Crime Information Center (FCIC) serves as the central repository for all criminal history records in the state of Florida, including:","c":["BIS system","Amber Alerts","Probation information","All answers Listed"],"a":"2","e":"FCIC also is the central repository for all criminal history records in the state of Florida, including wanted person information, missing person information, probation information, and information on offenders of special concern. Page: 145"},
{"q":"An inmate with serious and violent felony charges, either in the past or currently pending, or who poses a threat to the safety of staff and facility security, would typically be assigned which county security level?","c":["Confinement Security","Medium security","Maximum security","Community security"],"a":"2","e":"Maximum security level is for inmates who are considered high risk. These inmates have serious and violent felony charges, either in the past or currently pending, or pose a threat to the safety of staff as well as the security of the facility. Page: 150"},
{"q":"State facilities follow five custody grades. Which custody grade refers to inmates who are eligible for placement at a community residential facility?","c":["Minimum custody","Probation Custody","Community custody","Close custody"],"a":"2","e":"Community custody grade refers to inmates who are eligible for placement at a community residential facility. Page: 151"},
{"q":"When conducting a thorough search of inmate property, what should be done with prescription medication containers?","c":["Discard them immediately.","Check to ensure the name on the container is the inmate's.","Treat all medication, even in labeled containers, as contraband.","Allow the inmate to keep all medication regardless of labeling."],"a":"1","e":"Check any prescription medication containers to ensure that the name on the container is the inmate's. Page: 142"},
{"q":"Classification is a management tool used by facilities to assign security risk levels or custody grades to inmates. When are inmates classified?","c":["Only upon intake or reception.","When admitted to a facility as soon as practical.","Within 30 days, but usually within 48 hours.","Annually, regardless of behavior."],"a":"1","e":"Inmates are classified when admitted to a facility as soon as practical. Page: 150"},
{"q":"Inmate photographs may be used to generate an identification wristband or ID card. What information is often included on these computer-printed IDs?","c":["Inmate's photo","Sex and race","Date of birth and agency-generated identification number","All answers Listed"],"a":"3","e":"Most IDs are printed from a computer and often have the inmate's photo, sex, race, date of birth, and agency-generated identification number. Page: 149"},
{"q":"There are four destinations for inmate property. Which of the following is NOT one of these destinations?","c":["Destruction for items considered contraband","Retention by the inmate as specified in facility policies","Immediate return to the inmate's family","Storage until the inmate is released"],"a":"2","e":"There are four destinations for inmate property: destruction for items considered contraband; retention by the inmate as specified in facility policies; storage until the inmate is released; mailed to the inmate's designated recipient. Page: 142"},
{"q":"When inventorying and describing property that will be stored until an inmate's release, what is the correct procedure for listing jewelry?","c":["Determine the monetary value of each piece.","List by item, description, and color, avoiding value determination.","Only list watches by brand name and condition.","Only record missing stones if they are valuable."],"a":"1","e":"List jewelry by item, description, and color. Use terms such as \"yellow\" or \"white metal with clear tones.\" Avoid determining value. Page: 143"},
{"q":"To obtain industry standard quality prints using a LiveScan electronic submission machine, which of the following tips should be followed?","c":["Apply excessive pressure to ensure a dark print.","Roll each finger and thumb from nail to nail, then lift up and away to avoid smudging.","Use lotion on too-dry hands to moisten them.","Only capture prints from the fingertips."],"a":"1","e":"Roll each finger and thumb from nail to nail, then lift up and away to avoid smudging the print on the glass. Page: 147"},
{"q":"Which of the following are legal requirements regarding the use of FCIC/NCIC information?","c":["All persons using FCIC/NCIC must be certified.","Information is for criminal justice purposes only.","Information can be shared with family members if they have a valid reason.","Both 'All persons using FCIC/NCIC must be certified.' and 'Information is for criminal justice purposes only.' are correct."],"a":"3","e":"Legal requirements regarding the use of FCIC/NCIC information include...certification-all persons, officers, or civilians using FCIC/NCIC must be certified...restriction-information obtained from FCIC/NCIC is for criminal justice purposes only. Page: 146"},
{"q":"For inked fingerprint or palm print cards, where are signatures required?","c":["Only the inmate signs on the front.","Only the officer signs on the back.","Both the inmate and the officer taking the prints are required to sign the front of the card.","The inmate signs on the front, and the officer prints and signs their name on the back."],"a":"3","e":"Both the inmate and the officer taking the finger or palm prints are required to sign the finger or palm print card in the spaces provided: the inmate signs on the front; you will print and sign your name on the back. Page: 148"},
{"q":"Arrest papers are defined as the paperwork filed by the arresting officer that results in a person being arrested and taken to a detention facility for admission. Which of the following is a common feature of arrest papers?","c":["Judgment and sentence pages","Current criminal history printout from FCIC/NCIC","Probable cause affidavit","Medical transfer summary"],"a":"2","e":"Common features of arrest papers include: ... probable cause affidavit. Page: 138"},
{"q":"Confirming the completeness of arrest or commitment papers is a critical part of the intake/reception process. This includes ensuring that:","c":["All paperwork needed to complete the arrest or commitment is present.","Arrest paperwork is signed by the arresting officer.","The inmate's medical history is fully documented.","Both 'All paperwork needed to complete the arrest or commitment is present.' and 'Arrest paperwork is signed by the arresting officer.' are correct."],"a":"3","e":"Confirming completenes of arrest or commitment papers is a critical part of the intake/reception process and includes ensuring that: all paperwork needed to complete the arrest or commitment is present...arrest paperwork is signed by the arresting officer. Page: 139"},
{"q":"During the intake/reception process, inmates are permitted to keep certain documents while in custody. Which of the following are inmates allowed to keep?","c":["Copies of arrest papers","Personal cell phones","Legal paperwork pertaining to the inmate's case","Both 'Copies of arrest papers' and 'Legal paperwork pertaining to the inmate\\'s case' are correct."],"a":"3","e":"During the intake/reception process, the inmate is given the documents they are permitted to keep while in custody, including: court documents, legal paperwork pertaining to the inmate's case, copies of arrest papers. Page: 139"},
{"q":"Which of the following are common grounds for an inmate's release?","c":["Court order","Posting of bond","Inmate's Notice to Appear","Both 'Court order' and 'Posting of bond' are correct."],"a":"3","e":"Releases are granted through a court order, posting of bond, release on own recognizance (ROR), or expiration of sentence (EOS). Page: 153"},
{"q":"To verify release documentation, an officer should:","c":["Review the order for accuracy and completeness.","Confirm that the release order was issued for a specific inmate.","Verify that the release order was issued by the proper authority.","All answers Listed"],"a":"3","e":"To verify release documentation, review the order for accuracy and completeness, confirm that the release order was issued for a specific inmate, and verify that the release order was issued by the proper authority. Page: 153"},
{"q":"Before releasing an inmate, common procedures include:","c":["Notifying the inmate of their upcoming release.","Checking for outstanding warrants.","Resolving any grievances or claims for damage.","Everything Listed is correct."],"a":"3","e":"Common procedures to follow before releasing an inmate may include: notifying the inmate of their upcoming release... Additionally, you should check for outstanding warrants or detainers. Page: 153-154"},
{"q":"According to Florida Statutes (s. 943.325), DNA must be collected from persons convicted of or arrested for which types of offenses?","c":["At every initial misdemeanor offenses.","Felony or attempted offenses, and certain misdemeanor offenses.","Only sexual offenses.","Any offense that results in incarceration."],"a":"1","e":"Make sure you have obtained a DNA sample in accordance with the Florida Statutes (ss. 943.325 925.11), which require that DNA be collected from persons convicted of or arrested for felony or attempted offenses and convicted of certain misdemeanor offenses. Page: 154"},
{"q":"Which Florida Statute chapter mandates the inclusion of victim contact notification in arrest papers when such notification is required?","c":["Chapter 943, F.S.","Chapter 901, F.S.","Chapter 960, F.S.","Chapter 33, F.A.C."],"a":"2","e":"Victim contact notification, if required by chapter 960, F.S., must be included in arrest papers. Page: 138"},
{"q":"Which Florida Administrative Code rule specifies the provision of a discharge gratuity for qualified inmates released from the Department of Corrections?","c":["Rule 33-601.210, F.A.C.","Rule 33-601.502, F.A.C.","Rule 33-203.201, F.A.C.","Rule 33-103.001, F.A.C."],"a":"1","e":"A discharge gratuity is money given to qualified inmates who are released from the custody of the Department of Corrections in accordance with 33-601.502, F.A.C.. Page: 154"},
{"q":"Under which Florida Statute are photographs taken at intake or reception required to be submitted to FDLE along with finger and palm prints?","c":["s. 901.211, F.S.","s. 960.001, F.S.","s. 943.052, F.S.","s. 925.11, F.S."],"a":"2","e":"Photographs taken at intake or reception provide a visual record of each inmate and are submitted to FDLE electronically, along with finger and palm prints, as required by s. 943.052, F.S.. Page: 148"},
{"q":"Florida Statute s. 943.325 mandates DNA collection from certain offenders. Which other Florida Statute is mentioned in the provided materials in conjunction with s. 943.325 regarding DNA sample requirements?","c":["s. 901.211, F.S.","s. 925.11, F.S.","s. 943.052, F.S.","s. 960.03, F.S."],"a":"1","e":"Make sure you have obtained a DNA sample in accordance with the Florida Statutes (ss. 943.325 925.11), which require that DNA be collected from persons convicted of or arrested for felony or attempted offenses and convicted of certain misdemeanor offenses. Page: 154"},
{"q":"In Florida, county correctional facilities establish their own guidelines for intake, classification, and release based on various rulemaking bodies. Which of these is specifically mentioned as a guiding set of standards for these county facilities?","c":["Federal Bureau of Prisons Standards","American Correctional Association Standards","Florida Model Jail Standards","National Sheriffs' Association Guidelines"],"a":"2","e":"Based on the rulemaking bodies, the Florida Model Jail Standards or chapter 33 F.A.C., each facility establishes its own guidelines and procedures. Page: 137"},
{"q":"State correctional facilities in Florida primarily base their operational guidelines, including specific rules for custody grades, on which chapter of the Florida Administrative Code?","c":["Chapter 30, F.A.C.","Chapter 33, F.A.C.","Chapter 39, F.A.C.","Chapter 64, F.A.C."],"a":"1","e":"Based on the rulemaking bodies, the Florida Model Jail Standards or chapter 33 F.A.C., each facility establishes its own guidelines and procedures. State facilities follow the classification grades described in Rule 33-601.210, F.A.C.. Page: 137, 151"},
{"q":"Which body of law in Florida explicitly allows for additional criminal charges to be made against an inmate who introduces contraband into a correctional facility?","c":["Facility Policies and Procedures only","Florida Model Jail Standards","Florida Administrative Code","Florida Statutes"],"a":"3","e":"The Florida Statutes allow additional criminal charges to be made against an inmate who introduces contraband into the facility. Page: 142"},
{"q":"County facilities in Florida that process juveniles are expected to follow guidelines provided by which state department?","c":["Florida Department of Children and Families","Florida Department of Education","Florida Department of Juvenile Justice","Florida Department of Corrections"],"a":"2","e":"County facilities that process juveniles will follow guidelines provided by the Florida Department of Juvenile Justice. Page: 151"},
{"q":"What is the primary subject matter addressed by Rule 33-601.210, F.A.C., relevant to inmate management in Florida's state correctional facilities?","c":["Inmate disciplinary procedures","Inmate visitation rights","Inmate custody grades and classification","Inmate medical treatment protocols"],"a":"2","e":"State facilities follow the classification grades described in Rule 33-601.210, F.A.C.: community, minimum, medium, close, and maximum. Page: 151"},
{"q":"According to the provided materials, state facility rules in Florida generally permit strip searches for what primary purpose and at what general times?","c":["Only upon initial intake for security screening","To discourage contraband; conducted at any time, including entry/exit","For disciplinary reasons only after a formal hearing","Randomly for audit purposes, but specifically not during entry or exit"],"a":"1","e":"In state facilities, strip searches may be conducted on inmates entering or exiting the facility and may be conducted at any time to discourage the introduction and movement of contraband. Page: 141"},
{"q":"During a thorough search of an inmate's personal items at intake, what is the specific procedural step for handling any jewelry, including body piercings, they might be wearing?","c":["Allow the inmate to keep all jewelry as personal comfort items.","Immediately confiscate all jewelry and mark it for destruction.","Instruct the inmate to remove all jewelry so it can be examined for contraband and then inventoried.","Only inspect necklaces and rings, as body piercings are too difficult to remove safely."],"a":"2","e":"Instruct the inmate to take off any jewelry, including body piercings. Examine rings, necklaces, bracelets, and watches for disguised or concealed contraband. Page: 141"},
{"q":"If an intake officer performing intake duties notices that essential information or a required signature is missing from an inmate's arrest papers, what is the implied critical procedural step before the inmate's file can be officially created?","c":["Create the file with the available information and note the discrepancy for later.","Refuse admission to the inmate until the arresting agency corrects the papers.","Ensure the missing information is obtained and all required signatures are present on the documents.","Have the inmate sign a waiver acknowledging the incomplete paperwork."],"a":"2","e":"Confirming completenes of arrest or commitment papers is a critical part of the intake/reception process and includes ensuring that: all information is obtained; all paperwork needed...is present...arrest paperwork is signed by the arresting officer...commitment papers have been signed by the sentencing judge. The inmate's file is created once the arrest and intake/reception documents are completed and are signed. Page: 139"},
{"q":"What are the detailed procedural steps an officer should follow when searching an inmate's footwear for hidden contraband during intake?","c":["Briefly look inside each shoe and shake them once.","Ask the inmate if they have anything hidden in their shoes.","Remove insoles, inspect the area beneath the insoles, and then turn the footwear upside down, shaking or knocking it to dislodge items.","Only search footwear if a metal detector indicates the presence of an object."],"a":"2","e":"Check clothing carefully; systematically look for tears or hidden compartments in clothing and footwear in which small items or drugs could be hidden. Remove and inspect footwear insoles and the part of the shoe under the insole. Turn footwear upside down and shake or knock it against a hard object to dislodge any contraband that may be hidden inside. Page: 141"},
{"q":"Before facility-issued hygiene items (like soap or a toothbrush) are given to an inmate, what is the mandatory procedural step for the issuing officer?","c":["Offer the inmate a choice of available brands.","Thoroughly check the hygiene items themselves for any pre-existing contraband or tampering.","Have the inmate sign a form itemizing each hygiene product received.","Ensure the inmate has sufficient funds in their account to cover the cost."],"a":"1","e":"You must check the items issued for contraband before giving them to the inmate. Document the issuance of hygiene items in accordance with policies and procedures. Page: 143-144"},
{"q":"When utilizing a LiveScan machine for the purpose of obtaining an inmate's palm prints, what is the correct procedural method for capturing the full impression?","c":["The inmate should make a fist and press their knuckles onto the glass plate.","The officer should roll the inmate's palm from one edge to the other across the plate.","The officer should capture the palm impressions by ensuring the entire surface of the hand, from fingertips down to the wrist, makes contact with the plate.","Only the central part of the palm needs to be scanned for identification."],"a":"2","e":"Capture palm impressions from the surface of the hand from fingertips down to the wrist. Page: 147"},
{"q":"What is the standard operating procedure for the initial, temporary segregation of newly admitted male and female inmates during the intake/reception phase, prior to their permanent housing assignments?","c":["They may be held in the same multipurpose holding area if separated by a partial divider.","Male and female inmates must be entirely separated to prevent any normal sight and sound contact between them.","They can be in alternating cells as long as officers are present in the area.","Initial segregation is based on the nature of the offense, not gender."],"a":"1","e":"Male and female inmates should be separated to prevent normal sight and sound contact. Page: 151"},
{"q":"During the inmate release process, what specific procedural check on the release documentation ensures it pertains to the correct individual before any further steps are taken?","c":["Cross-referencing with the inmate's commissary account.","Comparing the physical description on the order with the inmate.","Confirming that the release order was issued for that specific inmate by checking identifiers.","Ensuring the inmate has no outstanding grievances."],"a":"2","e":"To verify release documentation, review the order for accuracy and completeness, confirm that the release order was issued for a specific inmate, and verify that the release order was issued by the proper authority. Page: 153"},
{"q":"According to standard intake/reception procedures outlined in your materials, at what point is an inmate's official facility file created?","c":["As soon as the inmate physically enters the facility grounds.","After the completion of the initial medical and psychological screening.","Once all arrest and intake/reception documents have been fully completed and properly signed by both the officer and the inmate.","Only after a permanent housing unit has been assigned to the inmate."],"a":"2","e":"The inmate's file is created once the arrest and intake/reception documents are completed and are signed by the officer and inmate. Page: 139"},
{"q":"If an intake officer at a county detention facility observes that an individual arriving for admission is unconscious or exhibits signs of serious illness or injury, what is the immediate procedural step mandated by Florida Model Jail Standards?","c":["The officer should admit the individual and schedule them for the next available medical sick call.","The individual should be placed in a temporary holding cell for observation by security staff.","The individual cannot be admitted without medical clearance; medical staff must assess if they can stay or if the arresting officer must transport them to a hospital.","The officer should attempt to obtain a signed medical waiver from the individual before admission."],"a":"2","e":"Florida Model Jail Standards prohibit admitting unconscious, seriously ill, or injured persons into a county facility without medical clearance. If an injury or impairment is present, medical staff will assess whether the person can remain at the facility or must be transported by the arresting officer to a hospital emergency room. Page: 139-140"},
{"q":"During the inmate property inventory procedure at intake, after any cash found in an inmate's possession has been counted and recorded by denomination and amount, what is the standard subsequent step for handling this money?","c":["The cash is sealed in an envelope and stored with the inmate's other physical property.","A portion of the cash is returned to the inmate for immediate needs, and the rest is stored.","The recorded money is deposited into the inmate's official facility account.","The cash is mailed directly to a family member designated by the inmate."],"a":"2","e":"Record money by denomination and amount, for example, 'two $20 bills, one $10 bill, two $5 bills, and three quarters for a total of $60.75.'... Deposit money in the inmate's account. Page: 143"},
{"q":"An inmate described as being eligible for placement at a work camp with a secure perimeter, but not for outside work assignments without armed supervision, would be classified under a State 'custody grade'. Which specific classification, distinct from a county 'security level', fits this detailed description?","c":["County Medium Security Level","State Medium Custody Grade","State Close Custody Grade","County Maximum Security Level"],"a":"1","e":"Medium custody grade refers to inmates who are eligible for placement at a work camp with a secure perimeter but who are not eligible for placement in an outside work assignment without armed supervision. State facilities follow the classification grades described in Rule 33-601.210, F.A.C., which are distinct from county security levels. Page: 150-151"},
{"q":"Both County and State correctional systems in Florida utilize a 'minimum' classification. Which statement most accurately reflects a key difference in their specific criteria or implications as detailed in the provided materials?","c":["County 'minimum security level' inmates are primarily those awaiting trial, while State 'minimum custody grade' inmates are post-sentencing.","State 'minimum custody grade' explicitly prohibits placement in a community residential center, a detail not as directly emphasized for the typical County 'minimum security level' definition provided.","Only State 'minimum custody grade' inmates are eligible for any type of outside work assignment; County 'minimum security level' inmates are restricted to in-facility tasks.","County 'minimum security level' applies only to inmates with no prior arrests, whereas State 'minimum custody grade' can include those with minimal criminal histories."],"a":"1","e":"Minimum custody grade refers to inmates who are eligible for outside work assignments but not for placement in a community residential center. Minimum security level is for inmates who are considered low risk, have adjusted well to being incarcerated, have a minimal criminal history with no violent charges in their history, or are currently charged with a non-violent crime. The explicit restriction from community residential centers is a key detail for the state's minimum custody grade. Page: 150-151"},
{"q":"The classification of an inmate is described as an ongoing process. If an inmate initially classified at a 'medium security level' in a county facility later exhibits behavior that poses a significant threat or incurs new serious charges, what is the likely reclassification outcome according to the text?","c":["Automatic transfer to a state facility under 'Close Custody Grade'.","Reclassification to 'Maximum Security Level' within the county facility.","A review with no change in security level but stricter in-cell restrictions.","Reclassification to 'Minimum Security Level' as a probationary measure."],"a":"1","e":"Classification is an ongoing process as reassessments are conducted throughout an inmate's incarceration. It may later be necessary to reclassify an inmate based on their behavior or new criminal charges. Maximum security level is for inmates who...pose a threat to the safety of staff as well as the security of the facility. Page: 150"},
{"q":"For an inmate in a Florida state facility classified under 'Close Custody Grade' as per Rule 33-601.210, F.A.C., what is the defining restriction regarding their movement and supervision when they are required to be outside a secure perimeter?","c":["They require intermittent visual checks by an officer.","They must be under direct, armed supervision.","They can be supervised by unarmed staff if within facility grounds.","They are permitted limited unescorted movement for essential services."],"a":"1","e":"Close custody grade refers to inmates who must be maintained within an armed perimeter or under direct, armed supervision when outside a secure perimeter. Page: 151"},
{"q":"While both County 'Maximum Security Level' and State 'Maximum Custody Grade' house high-risk individuals, what specific criterion uniquely defines the 'Maximum Custody Grade' in State facilities according to Rule 33-601.210, F.A.C.?","c":["The inmate has a history of multiple escape attempts from secure facilities.","The inmate has been designated as a leader of a security threat group.","The inmate is serving a life sentence without possibility of parole.","The inmate has been sentenced to death."],"a":"3","e":"Maximum custody grade refers to inmates who are sentenced to death. County Maximum security level is for inmates who are considered high risk due to serious and violent felony charges or posing a threat. Page: 150-151"},
{"q":"When establishing an inmate's initial custody grade or security risk level, which of the following factor-sets most comprehensively represents the diverse criteria utilized by correctional facilities, as detailed in the materials?","c":["Current charges, gang affiliation, and previous work assignments only.","Age, sex, and the inmate's stated housing preference only.","Length of sentence, medical/psychological needs, current charges, criminal history, age, sex, and past/current behavior.","Severity of the current offense and victim impact statements only."],"a":"2","e":"Some of the criteria that are used to establish an inmate's custody grade or security risk level include current charges, criminal history, age, sex, current and past behavior (discipline), medical and psychological needs, and degree of crime and length of sentence. Page: 150"},
{"q":"Considering the distinctions between State 'Medium Custody Grade' and 'Close Custody Grade' in Florida, what is a primary differentiating factor regarding an inmate's eligibility for placement or work assignments outside a conventionally armed perimeter?","c":["'Medium Custody' inmates can be in community residential facilities; 'Close Custody' inmates cannot.","'Medium Custody' inmates may be eligible for work camps with a secure perimeter, while 'Close Custody' inmates require direct armed supervision if outside any armed perimeter.","'Close Custody' inmates are allowed unescorted day passes for work; 'Medium Custody' inmates require armed escort.","'Medium Custody' is for first-time felons; 'Close Custody' is for repeat violent offenders."],"a":"1","e":"Medium custody grade refers to inmates who are eligible for placement at a work camp with a secure perimeter but who are not eligible for placement in an outside work assignment without armed supervision. Close custody grade refers to inmates who must be maintained within an armed perimeter or under direct, armed supervision when outside a secure perimeter. Page: 151"},
{"q":"Although classification considers multiple inmate characteristics, what is explicitly stated in the materials as the *overarching primary purpose* for assigning specific security risk levels or custody grades in correctional facilities?","c":["To effectively segregate different types of offenders to prevent institutional violence.","To ensure appropriate housing that meets inmate needs and provides reasonable protection for everyone within the facility.","To assign inmates to labor programs that match their skills and the facility's operational needs.","To accurately determine an inmate's parole eligibility date based on their assessed risk."],"a":"1","e":"The primary purpose for classification is to place inmates in the type of housing that best meets their needs and to provide reasonable protection for all inmates. Page: 151"},
{"q":"A county inmate is classified at 'Medium Security Level,' indicating a moderate risk. According to the text, what specific combination of past behavioral adjustment and criminal history typically forms the basis for this specific security level determination?","c":["First-time offender status with no prior incarcerations and a non-violent current charge.","A history of numerous minor disciplinary infractions but no violent offenses.","Previous adjustment to incarceration and a criminal history with only limited instances of violence.","Current charges for a serious, violent felony but with strong indications of potential for rehabilitation."],"a":"2","e":"Medium security level is for inmates who are considered moderate risk. These inmates have adjusted to being incarcerated in the past and have limited violence in their criminal history. Page: 150"},
{"q":"The materials indicate that inmates are classified 'as soon as practical' upon admission. How does this procedural timing of classification directly influence their subsequent permanent housing assignment?","c":["Classification is finalized only after a 30-day observation period in a general population housing unit.","Permanent housing is assigned based on space availability first, with classification adjustments made later if needed.","The outcome of the classification process, which assesses risk and needs, is a primary determinant for the type of housing unit an inmate is assigned to.","Inmates are housed in temporary intake units until their classification is complete, which typically aligns with their court disposition date."],"a":"2","e":"Inmates are classified when admitted to a facility as soon as practical. Housing assignments are based on an inmate's potential or basic risk and needs. After an inmate has completed the intake/reception process, they are assigned to a housing unit based on facility guidelines. Page: 150-151"},
{"q":"What is the term for the admission process in a state correctional facility, as distinct from a county facility?","c":["Intake","Onboarding","Reception","Induction"],"a":"2","e":"In state facilities, admission is known as reception. Page: 140"},
{"q":"Which term refers to the documents or orders from the court that place an inmate into the custody of a correctional facility?","c":["Arrest Papers","Probable Cause Affidavit","Commitment Papers","Notice to Appear"],"a":"2","e":"Commitment papers are defined as the documents or orders from the court that commit an inmate to the custody of a correctional facility. Page: 138"},
{"q":"What is the term for the process by which inmates are discharged from a correctional institution?","c":["Departure","Release","Conclusion","Exit"],"a":"1","e":"Release is the process by which inmates are discharged from a county detention facility or state correctional institution. Page: 153"},
{"q":"What does the acronym 'ROR' stand for in the context of pretrial procedures?","c":["Release on Requirement","Right of Refusal","Release on Recognizance","Rules of Release"],"a":"2","e":"ROR-release on recognizance, sometimes called a signature bond, is the pretrial release of an arrested person who promises in writing to appear for trial at a later date. Page: 138"},
{"q":"What is the vocabulary term for a raised portion of skin on the fingers and palms that is unique to each individual?","c":["Epidermal Marking","Dermal Papillae","Friction Ridge","Skin Striae"],"a":"2","e":"The friction ridge is a raised portion of skin on the fingers and palm of a hand that consists of connected ridge units. Page: 146"},
{"q":"In the context of inmate records, what does 'PII' stand for?","c":["Personal Inmate Information","Prior Incarceration Index","Personally Identifiable Information","Primary Investigation Information"],"a":"2","e":"PII stands for personally identifiable information-name, race, sex, date of birth, Social Security number, and aliases. Page: 145"},
{"q":"What is the term for a management tool used by facilities to assign custody grades or security risk levels to inmates?","c":["Evaluation","Screening","Assessment","Classification"],"a":"3","e":"Classification is a management tool used by facilities to assign security risk levels or custody grades to inmates. Page: 150"},
{"q":"Which vocabulary term describes money given to qualified inmates upon their discharge from the Department of Corrections?","c":["Release Stipend","Departure Payment","Discharge Gratuity","Exit Fund"],"a":"2","e":"A discharge gratuity is money given to qualified inmates who are released from the custody of the Department of Corrections in accordance with 33-601.502, F.A.C.. Page: 154"},
{"q":"What term describes the FDLE system that receives electronically submitted fingerprints from criminal justice facilities?","c":["Rapid ID","LiveScan","Biometric Identification Solution (BIS)","State Identification (SID)"],"a":"1","e":"FDLE's identification unit receives electronically submitted fingerprints through the LiveScan machine located at each criminal justice facility. Page: 148"},
{"q":"What is the term for an inmate who is eligible for placement at a community residential facility?","c":["Minimum custody grade","Medium custody grade","Community custody grade","Close custody grade"],"a":"2","e":"Community custody grade refers to inmates who are eligible for placement at a community residential facility. Page: 151"},
{"q":"Which term defines the lowest custody grade for state inmates, who are eligible for outside work but not community residential placement?","c":["Community custody grade","Minimum custody grade","Medium custody grade","Low-Risk grade"],"a":"1","e":"Minimum custody grade refers to inmates who are eligible for outside work assignments but not for placement in a community residential center. Page: 151"},
{"q":"What term is used for state inmates who are eligible for placement at a work camp with a secure perimeter but require armed supervision for outside work?","c":["Minimum custody grade","Medium custody grade","Close custody grade","Work-Release grade"],"a":"1","e":"Medium custody grade refers to inmates who are eligible for placement at a work camp with a secure perimeter but who are not eligible for placement in an outside work assignment without armed supervision. Page: 151"},
{"q":"Which custody grade term applies to state inmates who must be maintained within an armed perimeter or under direct, armed supervision when outside?","c":["Medium custody grade","Maximum custody grade","Secure custody grade","Close custody grade"],"a":"3","e":"Close custody grade refers to inmates who must be maintained within an armed perimeter or under direct, armed supervision when outside a secure perimeter. Page: 151"},
{"q":"What is the specific term for the highest state custody grade, which is assigned to inmates who have been sentenced to death?","c":["Death Row custody grade","Capital custody grade","Maximum custody grade","Close custody grade"],"a":"2","e":"Maximum custody grade refers to inmates who are sentenced to death. Page: 151"},
{"q":"In county facilities, what is the vocabulary term for the security level of inmates considered low risk with a minimal criminal history?","c":["Low security level","Basic security level","General Population level","Minimum security level"],"a":"3","e":"Minimum security level is for inmates who are considered low risk. Page: 150"},
{"q":"What term describes the security level for county inmates who are considered moderate risk and have adjusted to incarceration in the past?","c":["Standard security level","Medium security level","General security level","Moderate security level"],"a":"1","e":"Medium security level is for inmates who are considered moderate risk. These inmates have adjusted to being incarcerated in the past and have limited violence in their criminal history. Page: 150"},
{"q":"What is the term for the highest security level in county facilities, for inmates with serious violent charges or who pose a threat?","c":["High security level","Maximum security level","Secure housing level","Threat security level"],"a":"1","e":"Maximum security level is for inmates who are considered high risk. These inmates have serious and violent felony charges... or pose a threat to the safety of staff as well as the security of the facility. Page: 150"},
{"q":"What is the vocabulary term for a small, often portable fingerprint scanner that uses less than 10 prints for quick identification?","c":["LiveScan Lite","Biometric Identification Solution (BIS)","Rapid ID device","State Identification (SID) device"],"a":"2","e":"Many agencies in the state now confirm an inmate's identity with a Rapid ID device-a small, often portable fingerprint scanner using less than 10 prints. Page: 148"},
{"q":"What is the term for the unique number assigned to an inmate by the Department of Corrections during the reception process?","c":["State Identification Number (SID)","Offender Based Tracking System (OBTS) number","Department of Corrections number","Inmate File Number"],"a":"2","e":"During reception, an inmate is assigned a unique Department of Corrections number. Page: 140"},
{"q":"What is the 'OBTS' number found in an FCIC criminal history?","c":["Offender Booking and Transfer System","Official Bureau of Tracking Statistics","Offender Based Tracking System","On-site Booking and Tracking System"],"a":"2","e":"FCIC criminal histories contain...Florida arrest and registration history-Offender Based Tracking System (OBTS) number, date of arrest, county in which the arrest(s) occurred... Page: 145"},
{"q":"What is the vocabulary term for the state identification number (SID) that electronic fingerprint systems match to?","c":["State Inmate Database number","System Identification number","State Identification number","Secure Inmate Database number"],"a":"2","e":"The electronic system will match prints to an existing state identification number, known as a SID. Page: 148"},
{"q":"What does 'EOS' represent on an inmate's record?","c":["Emergency Offense Status","Expiration of Sentence","Early Onset Sentence","Evidence of Surrender"],"a":"1","e":"EOS-end (or expiration) of sentence. This date is determined by the court at sentencing and can be reduced due to gain time. Page: 139"},
{"q":"What is the term for the process of a juvenile being charged as an adult, transferring the case out of the Juvenile Division?","c":["Indicted","Waived","Certified","Direct Filed"],"a":"3","e":"A juvenile is direct filed when they are charged as an adult and the case is transferred out of the Juvenile Division. Page: 151"},
{"q":"What is the legal term for a document, included in arrest papers, that establishes the probable cause for an arrest?","c":["Judgment and Sentence","Writ of Habeas Corpus","Probable cause affidavit","Arrest Warrant"],"a":"2","e":"Common features of arrest papers include: probable cause affidavit. Page: 138"},
{"q":"What is the official name of the form used to document an inmate's personal property?","c":["Inmate Property Log","DC6-224","Personal Effects Inventory","Property and Contraband Form"],"a":"1","e":"DC6-224 is property Reciept. Page: 143"},
{"q":"In the context of criminal justice information, what does 'NCIC' stand for?","c":["National Crime Investigation Center","National Criminal Information Commission","National Crime Information Center","National Center for Inmate Classification"],"a":"2","e":"NCIC stands for National Crime Information Center. Page: 138"},
{"q":"What is the term for the national standards and best practice guidelines for facial images, recommended by FDLE?","c":["NIST Standards","FBI Facial Recognition Protocols","FISWG Guidelines","DHS Biometric Standards"],"a":"2","e":"When capturing, transmitting, and submitting facial images to FDLE, it is highly recommended that the national standards and best practice guidelines compiled by the Facial Identification Scientific Working Group (FISWG) be followed. Page: 148"},
{"q":"Which term refers to the standards that prohibit admitting a seriously ill person into a county facility without medical clearance?","c":["American Correctional Association Standards","Florida Statutes","Florida Model Jail Standards","Department of Health Rules"],"a":"2","e":"Florida Model Jail Standards prohibit admitting unconscious, seriously ill, or injured persons into a county facility without medical clearance. Page: 139"},
{"q":"What is the term for the system that uses a LiveScan machine to search state and national fingerprint databases?","c":["Automated Fingerprint Identification System (AFIS)","Biometric Identification Solution (BIS)","Rapid Identification System (Rapid ID)","National Crime Information Center (NCIC)"],"a":"1","e":"Fingerprints and palm prints are submitted to FDLE electronically via a Biometric Identification Solutions (BIS) LiveScan machine where they are searched against state and national fingerprint databases. Page: 146"},
{"q":"Which term describes the procedure of searching an inmate by removing their clothing?","c":["Pat Search","Frisk","Contraband Search","Strip Search"],"a":"3","e":"In state facilities, strip searches may be conducted on inmates entering or exiting the facility and may be conducted at any time to discourage the introduction and movement of contraband. Page: 141"},
{"q":"What is the term for the initial health evaluation done during intake or reception to determine immediate medical or psychological needs?","c":["Health Assessment","Medical Examination","Health Screening","Physical Evaluation"],"a":"2","e":"A health screening is done to establish immediate medical or psychological needs. Page: 140"},
{"q":"Which Florida Administrative Code rule pertains to the classification grades used by state facilities?","c":["33-601.502, F.A.C.","33-203.201, F.A.C.","33-601.210, F.A.C.","901.211, F.S."],"a":"2","e":"State facilities follow the classification grades described in Rule 33-601.210, F.A.C. Page: 151"},
{"q":"What is the term for the officer accountable for storing, inventorying, and documenting all inmate property?","c":["Intake Officer","Supply Officer","Classification Officer","Property Officer"],"a":"3","e":"The property officer is accountable for storing all property, making sure that the property room is secured at all times, inventorying property, and documenting the delivery or release of all property. Page: 143"},
{"q":"What term refers to the procedure where searches are conducted by officers of the same gender as the inmate?","c":["Gender-Appropriate Search","Same-Sex Search","Gender-Specific Search","Respectful Search"],"a":"2","e":"Searches of an inmate are gender specific (male officers search male inmates; female officers search female inmates) unless emergency situations require otherwise. Page: 141"},
{"q":"Which Florida Statute is the primary guide for conducting strip searches at county facilities?","c":["s. 943.325, F.S.","s. 901.211, F.S.","s. 943.052, F.S.","s. 960, F.S."],"a":"1","e":"At county facilities, strip searches are to be conducted only in accordance with s. 901.211, F.S.. Page: 141"},
{"q":"What is the term for the court document that determines the 'end of sentence' date for an inmate?","c":["Commitment Order","Probable Cause Affidavit","Judgment and sentence pages","Release on Recognizance"],"a":"2","e":"Common features of commitment papers include: judgment and sentence pages (signed by a judge). Page: 138"},
{"q":"What is the term for a summons or writ that is issued in place of a physical arrest?","c":["Release on Recognizance (ROR)","End of Sentence (EOS)","Commitment Paper","Notice to Appear (NTA)"],"a":"3","e":"NTA-notice to appear. This is a summons or writ issued in place of a physical arrest and which requires a person to appear in court. Page: 138"},
{"q":"Which term describes the reassessment of an inmate's classification that may occur due to behavior or new criminal charges?","c":["Initial Placement","Security Review","Reclassification","Housing Adjustment"],"a":"2","e":"Classification is an ongoing process as reassessments are conducted throughout an inmate's incarceration. It may later be necessary to reclassify an inmate based on their behavior or new criminal charges. Page: 150"},
{"q":"Which Florida Statute requires the electronic submission of photographs to FDLE along with fingerprints?","c":["s. 901.211, F.S.","s. 943.052, F.S.","s. 943.325, F.S.","s. 925.11, F.S."],"a":"1","e":"Photographs taken at intake or reception provide a visual record of each inmate and are submitted to FDLE electronically, along with finger and palm prints, as required by s. 943.052, F.S.. Page: 148"},
{"q":"What is the term for the guidelines provided by the Florida Department of Juvenile Justice that county facilities must follow for juvenile processing?","c":["Juvenile Justice Standards","Florida Model Jail Standards","DJJ Protocols","Department of Juvenile Justice Guidelines"],"a":"3","e":"County facilities that process juveniles will follow guidelines provided by the Florida Department of Juvenile Justice. Page: 151"},

];

function processAndCleanQuestions(questionArray) {
    // Filter out any null or undefined entries from the initial array
    const initialCleanedArray = questionArray.filter(q => q && typeof q === 'object');

    return initialCleanedArray.map((q_orig, index) => {
        // Deep copy the question object to avoid modifying the original
        let q = JSON.parse(JSON.stringify(q_orig)); 
        q.originalIndex = index; // Store original index

        // Convert answer to a number if it's a string
        if (typeof q.a === 'string') {
          q.a = parseInt(q.a, 10);
        }

        // Convert letter-based answer (a_letter) to numeric index (a)
        if (q.a_letter) { 
            const letterMap = { A: 0, B: 1, C: 2, D: 3 };
            q.a = letterMap[q.a_letter.toUpperCase()]; // Ensure uppercase for consistency
            delete q.a_letter; 
        }

        // Validate the answer index; default to 0 if invalid
        if (q.a === undefined || q.a < 0 || q.a >= q.c.length) {
            console.warn("Initial invalid answer index for question:", q.q, "Original index:", q_orig.a, "Defaulting to 0.");
            q.a = 0; 
        }
        
        // Store the correct answer text before shuffling choices
        let correctAnswerText = q.c[q.a]; 

        // Standardize "All of the above." to "All answers Listed"
        q.c = q.c.map(choice => choice === "All of the above." ? "(All answers listed)" : choice);
        if (correctAnswerText === "All of the above.") {
            correctAnswerText = "(All answers listed)";
        }
        
        // Shuffle the choices
        let shuffledChoices = shuffleArray([...q.c]); 
        // Find the new index of the correct answer after shuffling
        let newCorrectIndex = shuffledChoices.indexOf(correctAnswerText);

        // Handle cases where the correct answer text might not be found after shuffling (should be rare)
        if (newCorrectIndex === -1) {
            console.error("CRITICAL ERROR: Correct answer text '"+ correctAnswerText +"' not found after shuffling for question:", q.q, "Shuffled choices:", shuffledChoices, "Original choices were:", q.c);
            // Fallback: try to find it in the original, unshuffled choices
            newCorrectIndex = q.c.indexOf(correctAnswerText); 
            if (newCorrectIndex !== -1) {
                q.a = newCorrectIndex; 
            } else {
                q.a = 0; 
                console.error("ABSOLUTE FALLBACK: Could not find '"+ correctAnswerText +"' even in original choices for q: " + q.q + ". Using original choices and index 0.");
            }
        } else {
            q.c = shuffledChoices; 
            q.a = newCorrectIndex; 
        }
        return q;
    });
}

// Process the questions and store them in the questionPool
const questionPool = processAndCleanQuestions(newQuestionsFromUser);


let selectedQuestions = []; 
let currentIndex = 0;
const skipped = []; 
const flagged = []; 
let answers = []; 
let choiceVisibility = {}; 
let testId = ''; 
let timerSeconds = 1800; 
let isReviewMode = false;
let isStudyMode = false;
let incorrectlyAnswered = [];
let usedQuestionIndicesInPool = [];
let currentStudySetSize = 10;
var timerInterval;

function selectRandomQuestionsFromPool(pool, count) {
  const shuffledFullPool = shuffleArray([...pool]); 
  return shuffledFullPool.slice(0, count);
}

function renderQuiz() {
  const form = document.getElementById("quizForm");
  form.innerHTML = ''; 

  if (selectedQuestions.length === 0 ) {
    if(isStudyMode) showStudyEndActions();
    return;
  }
  if (!selectedQuestions[currentIndex]){
      // This can happen if we run out of incorrect questions to retry
      showStudyEndActions();
      return;
  }

  const q = selectedQuestions[currentIndex]; 
  const questionDiv = document.createElement("div"); 
  questionDiv.classList.add("question");
  questionDiv.innerHTML = `<div class='question-header'>Question ${currentIndex + 1}</div><div class='question-text'>${q.q}</div>`;
  
  const hasBeenAnsweredInStudy = isStudyMode && answers[currentIndex] !== null;

  q.c.forEach((choice, i) => {
    const choiceKey = `q${currentIndex}_c${i}`;
    const isVisuallyObscured = choiceVisibility[choiceKey] === true; 
    const isSelected = answers[currentIndex] === i;
    
    const eyeIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>`;
    const eyeOffIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>`;

    const choiceWrapper = document.createElement('div');
    choiceWrapper.className = 'choice-wrapper';
    if (isSelected && !isStudyMode) {
        choiceWrapper.classList.add('selected-wrapper');
    }
    
    const radioId = `${choiceKey}_radio`;
    choiceWrapper.innerHTML = `
        <label class="choice-button-main-area" for="${radioId}">
            <input type="radio" id="${radioId}" name="q${currentIndex}" value="${i}" ${isSelected ? 'checked' : ''} onclick="recordAnswer(${i})">
            <span class="choice-text-container">
              ${String.fromCharCode(65 + i)}. <span class="actual-choice-text ${isVisuallyObscured ? 'actual-choice-text-visually-obscured' : ''}">${choice}</span>
            </span>
        </label>
        <button type="button" class="toggle-visibility-btn" onclick="toggleChoiceVisibility(${currentIndex}, ${i}, event)">
          ${isVisuallyObscured ? eyeOffIconSVG : eyeIconSVG}
        </button>
    `;
    questionDiv.appendChild(choiceWrapper);
    
    if (hasBeenAnsweredInStudy) {
        const selectedAnswer = answers[currentIndex];
        const isCorrect = selectedAnswer === q.a;
        if (i === selectedAnswer) {
            choiceWrapper.classList.add(isCorrect ? 'study-correct' : 'study-incorrect');
        }
        if (i === q.a) {
            choiceWrapper.classList.add('study-correct');
        }
    }
  });
  
  const explanationDiv = document.createElement('div');
  explanationDiv.className = 'explanation';
  explanationDiv.id = `explanation-${currentIndex}`;
  explanationDiv.innerHTML = q.e;
  if(hasBeenAnsweredInStudy) {
      explanationDiv.style.display = 'block';
  }
  questionDiv.appendChild(explanationDiv);
  
  form.appendChild(questionDiv);
  
  document.getElementById("progressText").textContent = `Question ${currentIndex + 1} of ${selectedQuestions.length}`; 
  document.getElementById("progressTextBottom").textContent = `Question ${currentIndex + 1} of ${selectedQuestions.length}`; 
  
  document.getElementById("submitBtn").style.display = answers.every(a => a !== null) && !isStudyMode ? 'inline-block' : 'none';

  const flagButton = document.getElementById("flagButton");
  if (flagButton) { 
      flagButton.style.display = isStudyMode ? 'none' : 'inline-block';
    if (flagged.includes(currentIndex)) {
      flagButton.innerHTML = '✅ Unflag';
    } else {
      flagButton.innerHTML = '🚩 Flag';
    }
  }
  highlightNavItem(currentIndex); 
}

function toggleChoiceVisibility(qIndex, cIndex, event) {
    event.stopPropagation(); 
    const choiceKey = `q${qIndex}_c${cIndex}`;
    choiceVisibility[choiceKey] = !choiceVisibility[choiceKey]; 
    
    const buttonClicked = event.currentTarget; 
    const choiceWrapper = buttonClicked.closest('.choice-wrapper');
    if (!choiceWrapper) return;

    const textSpan = choiceWrapper.querySelector('.actual-choice-text');
    if (!textSpan) return;
    
    const eyeIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>`;
    const eyeOffIconSVG = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>`;

    if (choiceVisibility[choiceKey]) { 
        textSpan.classList.add('actual-choice-text-visually-obscured');
        buttonClicked.innerHTML = eyeOffIconSVG;
    } else {
        textSpan.classList.remove('actual-choice-text-visually-obscured');
        buttonClicked.innerHTML = eyeIconSVG;
    }
}


function recordAnswer(selectedIndex) {
    const alreadySelectedAndAnswered = answers[currentIndex] !== null;

    if (alreadySelectedAndAnswered) {
        if (isStudyMode) {
            nextQuestion();
        } else if (selectedIndex !== answers[currentIndex]) {
            answers[currentIndex] = selectedIndex;
            renderQuiz(); 
            generateSidebar();
        } else {
             nextQuestion();
        }
        return;
    }
    
    answers[currentIndex] = selectedIndex;

    const idxInSkipped = skipped.indexOf(currentIndex);
    if (idxInSkipped > -1) {
        skipped.splice(idxInSkipped, 1);
    }
    
    const questionDiv = document.getElementById("quizForm").querySelector(".question");
    
    if (isStudyMode) {
        const q = selectedQuestions[currentIndex];
        const isCorrect = selectedIndex === q.a;
        const choiceWrappers = questionDiv.querySelectorAll('.choice-wrapper');

        choiceWrappers.forEach((wrapper, i) => {
            if (i === selectedIndex) {
                wrapper.classList.add(isCorrect ? 'study-correct' : 'study-incorrect');
            }
            if (i === q.a) {
                wrapper.classList.add('study-correct');
            }
        });
        document.getElementById(`explanation-${currentIndex}`).style.display = 'block';

        if (!isCorrect) {
            if (!incorrectlyAnswered.some(item => item.originalIndex === q.originalIndex)) {
                incorrectlyAnswered.push(q);
            }
        }
        
        if (currentIndex === selectedQuestions.length - 1) {
            showStudyEndActions();
        }
    } else { 
        if (questionDiv) {
            const currentQuestionChoiceWrappers = questionDiv.querySelectorAll('.choice-wrapper');
            currentQuestionChoiceWrappers.forEach((wrapper, idx) => {
                wrapper.classList.remove('selected-wrapper');
                if (idx === selectedIndex) {
                    wrapper.classList.add('selected-wrapper');
                }
            });
        }
        document.getElementById("submitBtn").style.display = answers.every(a => a !== null) ? 'inline-block' : 'none';
    }
    
    generateSidebar(); 
}

function showStudyEndActions() {
    document.querySelector('.question-actions-bar').style.display = 'none';
    const studyEndActions = document.getElementById('studyEndActions');
    studyEndActions.style.display = 'block';

    const retryBtn = document.getElementById('retryIncorrectBtn');
    retryBtn.style.display = incorrectlyAnswered.length > 0 ? 'inline-block' : 'none';

    const nextSetBtn = document.getElementById('nextSetBtn');
    const remainingQuestions = questionPool.length - usedQuestionIndicesInPool.length;
    nextSetBtn.style.display = remainingQuestions >= currentStudySetSize ? 'inline-block' : 'none';
}

function startNextStudySet() {
    setupSession(true); // Call setupSession again, indicating it's the next set
}

function retryIncorrectQuestions() {
    selectedQuestions = shuffleArray([...incorrectlyAnswered]);
    currentIndex = 0;
    answers = new Array(selectedQuestions.length).fill(null);
    incorrectlyAnswered = [];
    flagged.length = 0;
    skipped.length = 0;

    document.getElementById('studyEndActions').style.display = 'none';
    document.querySelector('.question-actions-bar').style.display = 'flex';
    document.getElementById('nextBtn').style.display = 'inline-block';
    document.getElementById('prevBtn').style.display = 'inline-block';

    renderQuiz();
    generateSidebar();
}

function skipQuestion() {
  const questionToSkip = currentIndex;
  if (!skipped.includes(questionToSkip)) {
    skipped.push(questionToSkip);
  }
  nextQuestion(); 
}

function flagQuestion() {
  const indexInFlagged = flagged.indexOf(currentIndex);
  if (indexInFlagged > -1) {
    flagged.splice(indexInFlagged, 1); 
  } else {
    flagged.push(currentIndex); 
  }
  renderQuiz(); 
  generateSidebar(); 
}

function nextQuestion() {
  let potentialNextIndex = currentIndex + 1;

  if (potentialNextIndex >= selectedQuestions.length) { 
    if (isStudyMode) {
      showStudyEndActions();
      return;
    }
    potentialNextIndex = -1; 

    for (const skippedIdx of skipped) {
      if (answers[skippedIdx] === null) {
        potentialNextIndex = skippedIdx;
        break;
      }
    }

    if (potentialNextIndex === -1) {
      for (let i = 0; i < selectedQuestions.length; i++) {
        if (answers[i] === null) {
          potentialNextIndex = i;
          break;
        }
      }
    }
    
    if (potentialNextIndex === -1) {
      potentialNextIndex = currentIndex; 
    }
  }
  currentIndex = potentialNextIndex;
  renderQuiz();
  generateSidebar(); 
}

function prevQuestion() {
  if (currentIndex > 0) {
    currentIndex--;
  }
  renderQuiz();
  generateSidebar(); 
}

function displayReview() {
  isReviewMode = true; // Set review mode
  choiceVisibility = {}; 
  const form = document.getElementById("quizForm");
  form.innerHTML = ''; 
  let correctCount = 0;

  const reviewActionsTop = document.getElementById("reviewActionsTop");
  if(reviewActionsTop) reviewActionsTop.style.display = 'block';


  selectedQuestions.forEach((q, i) => { 
    const div = document.createElement("div");
    div.id = `review-q-${i}`; // Add ID for scrolling
    const isCorrect = answers[i] === q.a;
    const statusClass = isCorrect ? 'correct' : 'incorrect';
    const chosenAnswerText = (answers[i] !== null && q.c[answers[i]] !== undefined) ? q.c[answers[i]] : '<em>No answer provided</em>';
    const correctAnswerText = (q.a !== undefined && q.c[q.a] !== undefined) ? q.c[q.a] : '<em>Error: Correct answer not found</em>';
    
    div.className = statusClass; 
    div.innerHTML = `<div class='question-header'>Question ${i + 1}</div>` +
                      `<div class='question-text'>${q.q}</div>` +
                      `<p>Your Answer: ${chosenAnswerText}</p>` +
                      `<p>Correct Answer: ${correctAnswerText}</p>` +
                      `<div class='explanation' style="display:block;">${q.e}</div><hr>`;
    if (isCorrect) correctCount++;
    form.appendChild(div);
  });
  
  const scoreHeader = document.createElement("h2");
  scoreHeader.id = "reviewSummaryHeader"; 
  scoreHeader.style.textAlign = "center";
  scoreHeader.innerHTML = `Review Summary<br>You answered ${correctCount} out of ${selectedQuestions.length} correctly.`; 
  
  const quizContentScrollable = document.getElementById("quizContentScrollable");
  const referenceNodeForHeader = document.getElementById("quizForm"); 

  if (reviewActionsTop && reviewActionsTop.parentNode === quizContentScrollable) {
      quizContentScrollable.insertBefore(scoreHeader, reviewActionsTop.nextSibling);
  } else if (referenceNodeForHeader && referenceNodeForHeader.parentNode === quizContentScrollable) {
      quizContentScrollable.insertBefore(scoreHeader, referenceNodeForHeader);
  } else {
      const progressDiv = document.getElementById('progress');
      if (progressDiv && progressDiv.parentNode === quizContentScrollable) {
          quizContentScrollable.insertBefore(scoreHeader, progressDiv.nextSibling);
      } else {
          quizContentScrollable.prepend(scoreHeader); 
      }
  }
  
  document.getElementById("progressText").textContent = "Review Mode";
  document.getElementById("progressTextBottom").textContent = "Review Mode";
  
  const questionActionsBar = document.querySelector(".question-actions-bar");
  if(questionActionsBar) questionActionsBar.style.display = 'none';
  document.getElementById("flagButton").style.display = 'none';
  
  const reviewActionsBottom = document.getElementById("reviewActionsBottom");
  if(reviewActionsBottom) reviewActionsBottom.style.display = 'block';
  generateSidebar(); // Refresh sidebar with review colors
}

function returnToHome() {
    isReviewMode = false; // Exit review mode
    isStudyMode = false;
    const reviewActionsTop = document.getElementById("reviewActionsTop");
    if(reviewActionsTop) reviewActionsTop.style.display = 'none';
    const reviewActionsBottom = document.getElementById("reviewActionsBottom");
    if(reviewActionsBottom) reviewActionsBottom.style.display = 'none';
    const studyEndActions = document.getElementById("studyEndActions");
    if(studyEndActions) studyEndActions.style.display = 'none';
    
    const scoreHeader = document.getElementById("reviewSummaryHeader");
    if (scoreHeader) {
        scoreHeader.remove();
    }
    
    document.getElementById('mainQuizContainer').style.display = 'none';
    document.getElementById('resultsScreen').style.display = 'none'; 
    document.getElementById('introScreen').style.display = 'flex';
    document.getElementById('homeBtn').style.display = 'none'; 

    const timerDisplay = document.getElementById('timer');
    if(timerDisplay) timerDisplay.textContent = "30:00"; 
    
    currentIndex = 0;
    answers = [];
    skipped.length = 0; 
    flagged.length = 0;
    choiceVisibility = {};
    selectedQuestions = []; 
    incorrectlyAnswered = [];
    usedQuestionIndicesInPool = [];
}


function submitAll() {
  let correct = 0;
  selectedQuestions.forEach((q, i) => { 
    if (answers[i] === q.a) correct++;
  });
  const scorePercentage = selectedQuestions.length > 0 ? (correct / selectedQuestions.length) * 100 : 0;

  document.getElementById("mainQuizContainer").style.display = "none";
  document.getElementById("resultsScreen").style.display = "flex";
  document.getElementById("finalScore").textContent = `${scorePercentage.toFixed(0)}%`;
  document.getElementById("testIdDisplay").textContent = testId; 

  clearInterval(timerInterval); 
  const timerDisplay = document.getElementById('timer');
  if(timerDisplay) timerDisplay.textContent = "00:00"; 
}

function showReviewPage() {
  isReviewMode = true; // Set review mode
  document.getElementById("resultsScreen").style.display = "none";
  document.getElementById("submitScreen").style.display = "none"; 
  document.getElementById("mainQuizContainer").style.display = "block"; 
  
  const questionActionsBar = document.querySelector(".question-actions-bar");
  if(questionActionsBar) questionActionsBar.style.display = 'none'; 
  document.getElementById("flagButton").style.display = 'none'; 

  displayReview(); 
}

function startExam() {
    isStudyMode = false;
    isReviewMode = false;
    usedQuestionIndicesInPool = []; // Reset used questions for a new exam
    setupSession();
}

function startStudy() {
    isStudyMode = true;
    isReviewMode = false;
    usedQuestionIndicesInPool = []; // Reset used questions for a new study session
    setupSession();
}

function setupSession(isNextSet = false) {
    if(!isNextSet) {
        usedQuestionIndicesInPool = [];
    }
  document.getElementById('introScreen').style.display = 'none';
  document.getElementById('mainQuizContainer').style.display = 'block'; 
  document.getElementById('homeBtn').style.display = 'flex';
  
  const mainHeader = document.getElementById('mainHeaderTitle');
  const timerDisplay = document.getElementById('timer');
  const questionActionsBar = document.querySelector(".question-actions-bar");
  const flagButton = document.getElementById("flagButton");
  const studyEndActions = document.getElementById("studyEndActions");

  studyEndActions.style.display = 'none';
  questionActionsBar.style.display = 'flex'; 

  if (isStudyMode) {
      mainHeader.textContent = "Answer & Study";
      timerDisplay.style.display = 'none';
      document.getElementById('submitBtn').style.display = 'none';
      document.getElementById('skipBtn').style.display = 'none';
  } else {
      mainHeader.textContent = 'Exam';
      timerDisplay.style.display = 'block';
      document.getElementById('submitBtn').style.display = 'none';
      document.getElementById('skipBtn').style.display = 'inline-block';
  }


  const reviewActionsTop = document.getElementById("reviewActionsTop");
  if(reviewActionsTop) reviewActionsTop.style.display = 'none';
  const reviewActionsBottom = document.getElementById("reviewActionsBottom");
  if(reviewActionsBottom) reviewActionsBottom.style.display = 'none';
  
  const oldScoreHeader = document.getElementById("reviewSummaryHeader");
  if (oldScoreHeader) oldScoreHeader.remove();

  if(flagButton) flagButton.style.display = isStudyMode ? 'none' : 'inline-block';

  const questionCountSelect = document.getElementById('questionCount');
  let numberOfQuestions;

  if (questionCountSelect && questionCountSelect.value === 'all') {
    numberOfQuestions = questionPool.length;
  } else if (questionCountSelect) {
    numberOfQuestions = parseInt(questionCountSelect.value, 10);
  } else {
    numberOfQuestions = 10; // Fallback
  }
  currentStudySetSize = numberOfQuestions;

  // Select questions for the session
    let availableQuestions = questionPool.filter(q => !usedQuestionIndicesInPool.includes(q.originalIndex));
    let shuffled = shuffleArray(availableQuestions);
    selectedQuestions = shuffled.slice(0, currentStudySetSize);
    selectedQuestions.forEach(q => usedQuestionIndicesInPool.push(q.originalIndex));

  
  answers = new Array(selectedQuestions.length).fill(null); 
  choiceVisibility = {}; 
  testId = `TEST-${Date.now()}-${Math.floor(Math.random() * 1000)}`;
  currentIndex = 0;
  skipped.length = 0; 
  flagged.length = 0;
  incorrectlyAnswered = [];

  adjustFooterPadding(); 

  generateSidebar(); 
  renderQuiz(); 

  if (!isStudyMode) {
    timerSeconds = numberOfQuestions * 60; 
    const initialMin = String(Math.floor(timerSeconds / 60)).padStart(2, '0');
    const initialSec = String(timerSeconds % 60).padStart(2, '0');
    if(timerDisplay) timerDisplay.textContent = `${initialMin}:${initialSec}`;

    clearInterval(timerInterval); 
    timerInterval = setInterval(() => {
      if (timerSeconds > 0) {
        timerSeconds--;
        const min = String(Math.floor(timerSeconds / 60)).padStart(2, '0');
        const sec = String(timerSeconds % 60).padStart(2, '0');
        if(timerDisplay) timerDisplay.textContent = `${min}:${sec}`;
      } else {
        submitAll(); 
        clearInterval(timerInterval);
      }
    }, 1000);
  }
}

function showSubmitScreen() {
  document.getElementById("submitScreen").style.display = "flex"; 
}
function hideSubmitScreen() {
  document.getElementById("submitScreen").style.display = "none";
}
function confirmAndSubmit() {
  const confirmMessageDiv = document.getElementById("confirmSubmitMessage");
  const confirmSubmitCheckbox = document.getElementById("confirmSubmit");

  if (confirmSubmitCheckbox && confirmSubmitCheckbox.checked) {
    if(confirmMessageDiv) confirmMessageDiv.textContent = ""; 
    submitAll();
  } else {
    if(confirmMessageDiv) confirmMessageDiv.textContent = "Please confirm you have completed the exam.";
    setTimeout(() => { 
        if(confirmMessageDiv) confirmMessageDiv.textContent = ""; 
    }, 3000);
  }
}

function generateSidebar() {
  const sidebar = document.getElementById("sidebar");
  if (sidebar && getComputedStyle(sidebar).display === 'none' && window.innerWidth <= 767) {
      return; 
  }

  const ul = document.getElementById("questionNav");
  if (!ul) return; 
  ul.innerHTML = ''; 
  for (let i = 0; i < selectedQuestions.length; i++) {
    const li = document.createElement("li");
    li.innerHTML = `<button ondblclick="jumpToQuestion(${i})" onclick="jumpToQuestion(${i})" id="nav-${i}" style="width: 40px; height: 40px; margin: 5px auto; border-radius: 50%; border: none; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center;">${i + 1}</button>`;
    ul.appendChild(li);
    highlightNavItem(i); 
  }
}

function jumpToQuestion(index) {
  currentIndex = index; // Always update the current index

  if (isReviewMode) {
    const element = document.getElementById(`review-q-${index}`);
    if (element) {
        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
  } else {
    renderQuiz();
  }
  generateSidebar(); // Update sidebar for both modes
}

function highlightNavItem(index) {
    const btn = document.getElementById(`nav-${index}`);
    if (!btn) return;

    const isCurrent = index === currentIndex;
    let bg, color, border, iconText;
    iconText = `${index + 1}`;
    border = '2px solid transparent';

    const mode = isReviewMode || (isStudyMode && answers[index] !== null) ? 'review' : 'quiz';

    switch (mode) {
        case 'review':
            const isCorrect = answers[index] === selectedQuestions[index].a;
            if (answers[index] === null) {
                bg = '#6b7280'; // Gray for unanswered/skipped in review
                color = '#fff';
            } else if (isCorrect) {
                bg = '#22c55e'; // Green for correct
                color = '#fff';
            } else {
                bg = '#ef4444'; // Red for incorrect
                color = '#fff';
            }
            break;
        case 'quiz':
        default:
            const isAnswered = answers[index] !== null;
            const isSkipped = skipped.includes(index);
            const isFlagged = flagged.includes(index);

            bg = '#d0d0d0';
            color = '#000';

            if (isAnswered) {
                bg = '#3b82f6';
                color = '#fff';
            } else if (isSkipped) {
                bg = '#6b7280';
                color = '#fff';
                iconText += ' ⏸';
            }

            if (isFlagged) {
                iconText += ' 🚩';
            }
            break;
    }

    if (isCurrent) {
        border = '2px solid #1d4ed8'; // Highlight current item in both modes
        if (!isReviewMode && !isStudyMode && answers[index] === null && !skipped.includes(index)) {
            bg = '#e5e7eb';
            color = '#000';
        }
    }

    btn.style.background = bg;
    btn.style.color = color;
    btn.style.border = border;
    btn.innerHTML = iconText.trim();

    if (isCurrent && !isReviewMode && !isStudyMode && btn.scrollIntoView) {
        btn.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}


function adjustFooterPadding() {
    const footer = document.querySelector('.quiz-controls');
    const sidebar = document.getElementById('sidebar');
    if (footer && getComputedStyle(footer).position === 'fixed') {
        let footerHeight = footer.offsetHeight;
        document.body.style.paddingBottom = footerHeight + 'px';
        if (sidebar && getComputedStyle(sidebar).display !== 'none') { 
            sidebar.style.bottom = footerHeight + 'px';
        }
    }
}

document.addEventListener("DOMContentLoaded", () => {
    adjustFooterPadding(); 
    window.addEventListener('resize', adjustFooterPadding); 

    if (document.getElementById('introScreen').style.display !== 'none') {
        const mainQuizContainer = document.getElementById('mainQuizContainer');
        if (mainQuizContainer) mainQuizContainer.style.display = 'none';
    }

    const questionCountSelect = document.getElementById('questionCount');
    if (questionCountSelect) {
        questionCountSelect.innerHTML = ''; // Clear existing options

        const options = [10, 25, 50]; // Define standard options
        options.forEach(num => {
            if (questionPool.length >= num) { // Only add option if there are enough questions
                const option = document.createElement('option');
                option.value = num;
                option.textContent = num;
                questionCountSelect.appendChild(option);
            }
        });

        // Set a default selected value
        if (questionCountSelect.options.length > 0) {
            const defaultOption = questionCountSelect.querySelector('option[value="50"]') || questionCountSelect.options[questionCountSelect.options.length - 1];
            if(defaultOption) defaultOption.selected = true;
        }

        // Add the "All Questions" option
        const allQuestionsOption = document.createElement('option');
        allQuestionsOption.value = 'all';
        allQuestionsOption.textContent = `All (${questionPool.length} Questions)`;
        questionCountSelect.appendChild(allQuestionsOption);
    }
});

</script>
</body>
</html>
